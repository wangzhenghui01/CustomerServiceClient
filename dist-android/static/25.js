webpackJsonp([25],{381:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),l=a(s),r=n(7),c=a(r),i=n(3),o=function(){var e=(0,c.default)(l.default.mark(function e(t){var n,a;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.selectdata){e.next=2;break}return e.abrupt("return");case 2:return n={tablename:"t_material",condition:"f_uuuid = '"+t.selectdata.f_process_id+"' and f_type = '报建'"},a=new i.HttpResetClass,e.next=6,a.load("POST","rs/sql/singleTable",{data:n},{resolveMsg:null,rejectMsg:"获取材料信息失败"}).then(function(e){t.model.rows=[],t.model.rows=e.data,t.params=e.data});case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();t.default={title:"材料信息",props:["selectdata","edit"],data:function(){return{fmaterialtype:[],fmaterialname:[],fmaterialspec:[],fmaterialprice:[],headers:{username:this.$login.f.name,blodid:this.selectdata.f_process_id,fusetype:"报建execl导入材料"},params:null,record:{},selectItem:{},model:{rows:[]},show:!1,isShow:!1}},ready:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(l.default.mark(function e(){return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.load();case 1:case"end":return e.stop()}},e,this)}));return e}(),watch:{selectdata:function(){this.headers.blodid=this.selectdata.f_process_id,o(this)}},computed:{fprice:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(l.default.mark(function e(){var t,n,a,s=this;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.selectItem.f_material_type&&this.selectItem.f_material_name&&this.selectItem.f_material_spec)){e.next=8;break}return this.fmaterialprice=[],t=new i.HttpResetClass,n={columnname:"f_price",tablename:"t_material",condition:"f_material_type = '"+this.selectItem.f_material_type+"' and f_material_name = '"+this.selectItem.f_material_name+"' and f_material_spec = '"+this.selectItem.f_material_spec+"' ORDER  BY f_price desc"},e.next=6,t.load("POST","rs/sql/getdistinct",{data:n},{resolveMsg:null,rejectMsg:"获取f_material_type失败"},{silent:!0});case 6:a=e.sent,a.data.forEach(function(e){var t={label:e.f_price,value:e.f_price};s.fmaterialprice.push(t)});case 8:case"end":return e.stop()}},e,this)}));return e}(),fmaterialnames:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(l.default.mark(function e(){var t,n,a,s,r=this;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.selectItem.f_material_type){e.next=9;break}return this.fmaterialname=[],t=this.selectItem.f_material_type,n=new i.HttpResetClass,a={columnname:"f_material_name",tablename:"t_material",condition:"f_material_type = '"+t+"'"},e.next=7,n.load("POST","rs/sql/getdistinct",{data:a},{resolveMsg:null,rejectMsg:"获取f_material_name失败"},{silent:!0});case 7:s=e.sent,s.data.forEach(function(e){var t={label:e.f_material_name,value:e.f_material_name};r.fmaterialname.push(t)});case 9:case"end":return e.stop()}},e,this)}));return e}(),fmaterialspecs:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(l.default.mark(function e(){var t,n,a,s,r=this;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.selectItem.f_material_name){e.next=9;break}return this.fmaterialspec=[],t=this.selectItem.f_material_name,n=new i.HttpResetClass,a={columnname:"f_material_spec",tablename:"t_material",condition:"f_material_name = '"+t+"'"},e.next=7,n.load("POST","rs/sql/getdistinct",{data:a},{resolveMsg:null,rejectMsg:"获取f_material_spec失败"},{silent:!0});case 7:s=e.sent,s.data.forEach(function(e){var t={label:e.f_material_spec,value:e.f_material_spec};r.fmaterialspec.push(t)});case 9:case"end":return e.stop()}},e,this)}));return e}()},methods:{updateData:function(e){this.headers.blodid=e.f_process_id,this.selectdata=e},load:function(){function e(){return t.apply(this,arguments)}var t=(0,c.default)(l.default.mark(function e(){var t,n,a,s=this;return l.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new i.HttpResetClass,n={columnname:"f_material_type",tablename:"t_material",condition:"1=1"},e.next=4,t.load("POST","rs/sql/getdistinct",{data:n},{resolveMsg:null,rejectMsg:null},{silent:!0});case 4:a=e.sent,a.data.forEach(function(e){var t={label:e.f_material_type,value:e.f_material_type};s.fmaterialtype.push(t)});case 6:case"end":return e.stop()}},e,this)}));return e}(),impexcel:function(){this.isShow=!0},closeFile:function(){this.isShow=!1,this.$refs.file.$el.querySelector("input").value=""},deleteItem:function(e){var t=this;this.$showMessage("删除后不可恢复，确认删除吗？",["confirm","cancel"]).then(function(n){"confirm"===n&&t.$resetpost("rs/logic/applyDeleteValue",{tablename:"t_material",id:e.id}).then(function(e){o(t)})})},filterParams:function(e){if(e&&""!==e){for(var t=[],n=0;n<this.model.rows.length;n++)this.model.rows[n].f_material_name.includes(e)&&t.push(this.model.rows[n]);this.model.rows=t}else this.model.rows=this.params},add:function(){this.show=!0},modifyParam:function(e){this.$set("selectItem.id",e.id),this.$set("selectItem.f_uuuid",e.f_uuuid),this.$set("selectItem.f_material_type",e.f_material_type),this.$set("selectItem.f_material_name",e.f_material_name),this.$set("selectItem.f_material_spec",e.f_material_spec),this.$set("selectItem.f_quantity",e.f_quantity),this.$set("selectItem.f_price",e.f_price),this.$set("selectItem.f_money",e.f_money),this.$set("selectItem.f_remarks",e.f_remarks),this.show=!0},paychange:function(e){var t=new i.HttpResetClass;e.f_pay=!e.f_pay,t.load("POST","rs/logic/saveentity",{data:{tablename:"t_material",parameters:e}},{resolveMsg:null,rejectMsg:"缴费状态更新失败"},{silent:!0})},confirm:function(){var e=this;if(this.selectItem.f_uuuid){var t={tablename:"t_material",parameters:this.selectItem};this.$resetpost("rs/logic/saveentity",{data:t}).then(function(t){e.show=!1,o(e),e.selectItem={}})}else{this.selectItem.f_type="报建",this.selectItem.f_uuuid=this.selectdata.f_process_id;var n={tablename:"t_material",parameters:this.selectItem};this.$resetpost("rs/logic/save",{data:n}).then(function(t){e.show=!1,o(e),e.selectItem={}})}},close:function(){this.show=!1,this.selectItem={}}},events:{onFileUpload:function(e,t){var n=this;if(!this.selectdata.f_process_id)return void this.$showMessage("数据异常，导入失败");var a={tablename:"f_material",filepath:t.f_downloadpath,f_process_id:this.selectdata.f_process_id};this.$resetpost("rs/logic/materialImport",a,{resolveMsg:"上传成功",rejectMsg:"上传失败"}).then(function(e){n.load(),console.log("dddddddd",n),n.closeFile()})}}}},506:function(e,t,n){t=e.exports=n(4)(),t.push([e.id,".recordTable table tr th[_v-4060e2ce]{font-weight:700}.recordTable table tr[_v-4060e2ce]:hover{background-color:#e6e6e6}td[_v-4060e2ce]{text-align:center!important}.input-select[_v-4060e2ce]{width:100%;height:34px;-ms-flex-line-pack:center;align-content:center;margin-top:10px}","",{version:3,sources:["/./src/components/product/Process/Processes/CustomerMaterialMessage.vue"],names:[],mappings:"AA2YA,sCACE,eAAkB,CACnB,AAED,yCACE,wBAAqC,CACtC,AAED,gBACE,2BAA6B,CAC9B,AAED,2BACE,WAAY,AACZ,YAAa,AACb,0BAA2B,AACvB,qBAAsB,AAC1B,eAAiB,CAClB",file:"CustomerMaterialMessage.vue",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.recordTable table tr th[_v-4060e2ce] {\n  font-weight: bold;\n}\n\n.recordTable table tr[_v-4060e2ce]:hover {\n  background-color: rgb(230, 230, 230);\n}\n\ntd[_v-4060e2ce] {\n  text-align: center !important\n}\n\n.input-select[_v-4060e2ce] {\n  width: 100%;\n  height: 34px;\n  -ms-flex-line-pack: center;\n      align-content: center;\n  margin-top: 10px;\n}\n"],sourceRoot:"webpack://"}])},589:function(e,t,n){var a=n(506);"string"==typeof a&&(a=[[e.id,a,""]]);n(5)(a,{});a.locals&&(e.exports=a.locals)},785:function(e,t){e.exports=' <div class=flex _v-4060e2ce=""> <div class="form-inline auto" style="margin-bottom: 5px" _v-4060e2ce=""> <label _v-4060e2ce="">材料查找：</label> <input type=text class=form-control placeholder=请输入查找的材料名称 v-model=param @keyup.enter=filterParams(param) _v-4060e2ce=""> <button type=button class="btn btn-primary" @click=filterParams(param) _v-4060e2ce="">查询</button> <button type=button class="btn btn-warning" @click=add() v-show=edit _v-4060e2ce="">新增</button> <div class=form-inline style="float: right" _v-4060e2ce=""> <button type=button class="btn btn-warning add-postition" @click=impexcel() v-show=edit _v-4060e2ce="">导入</button> </div> </div> <div class="col-sm-12 span recordTable" style="margin-top: 10px;min-height: 500px" _v-4060e2ce=""> <partial-view v-ref:single-load="" _v-4060e2ce=""> <data-grid :model=model v-ref:grid="" _v-4060e2ce=""> <template partial=head> <tr _v-4060e2ce=""> <th _v-4060e2ce="">序号</th> <th _v-4060e2ce="">材料类型</th> <th _v-4060e2ce="">材料名称</th> <th _v-4060e2ce="">材料规格</th> <th _v-4060e2ce="">数量</th> <th _v-4060e2ce="">单价</th> <th _v-4060e2ce="">金额</th> <th v-show=edit _v-4060e2ce="">是否缴费</th> <th v-show=edit _v-4060e2ce="">操作</th> </tr> </template> <template partial=body> <td _v-4060e2ce="">{{$index+1}}</td> <td _v-4060e2ce="">{{row.f_material_type}}</td> <td _v-4060e2ce="">{{row.f_material_name}}</td> <td _v-4060e2ce="">{{row.f_material_spec}}</td> <td _v-4060e2ce="">{{row.f_quantity}}</td> <td _v-4060e2ce="">{{row.f_price}}</td> <td _v-4060e2ce="">{{row.f_money}}</td> <td v-show=edit _v-4060e2ce=""><input type=checkbox v-model=row.f_pay @click=$parent.$parent.$parent.paychange(row) _v-4060e2ce=""></td> <td class=flex-around _v-4060e2ce=""> <button type=button name=button class="btn btn-link" @click.stop=$parent.$parent.$parent.modifyParam(row) v-show=edit _v-4060e2ce="">修改 </button> <button type=button name=button class="btn btn-link" @click.stop=$parent.$parent.$parent.deleteItem(row) v-show=edit _v-4060e2ce="">删除 </button> </td> </template> </data-grid> </partial-view> </div> </div> <modal :show.sync=show v-ref:modal="" backdrop=false _v-4060e2ce=""> <header slot=modal-header class=modal-header _v-4060e2ce=""> <button type=button class=close @click=close _v-4060e2ce=""><span _v-4060e2ce="">×</span></button> <h4 class=modal-title _v-4060e2ce="">配置</h4> </header> <article slot=modal-body class=modal-body _v-4060e2ce=""> <div class=from-group _v-4060e2ce=""> <label _v-4060e2ce="">材料类型</label> <input-select class=input-select :value.sync=selectItem.f_material_type v-model=selectItem.f_material_type v-ref:customertype="" :options=fmaterialtype @change=fmaterialnames close-on-select="" _v-4060e2ce=""></input-select> </div> <div class=from-group _v-4060e2ce=""> <label _v-4060e2ce="">材料名称</label> <input-select class=input-select :value.sync=selectItem.f_material_name v-model=selectItem.f_material_name v-ref:customertype="" :options=fmaterialname @change=fmaterialspecs close-on-select="" _v-4060e2ce=""></input-select> </div> <div class=from-group _v-4060e2ce=""> <label _v-4060e2ce="">材料规格</label> <input-select class=input-select :value.sync=selectItem.f_material_spec v-model=selectItem.f_material_spec v-ref:customertype="" :options=fmaterialspec @change=fprice close-on-select="" _v-4060e2ce=""></input-select> </div> <div class=from-group _v-4060e2ce=""> <label _v-4060e2ce="">单价</label> <input-select class=input-select :value.sync=selectItem.f_price v-model=selectItem.f_price v-ref:customertype="" :options=fmaterialprice close-on-select="" _v-4060e2ce=""></input-select> </div> <div class=from-group _v-4060e2ce=""> <label _v-4060e2ce="">数量</label> <input type=text class=form-control v-model=selectItem.f_quantity _v-4060e2ce=""> </div> <div class=from-group _v-4060e2ce=""> <label _v-4060e2ce="">金额</label> <input type=text class=form-control v-model=selectItem.f_money _v-4060e2ce=""> </div> <div class=from-group _v-4060e2ce=""> <label _v-4060e2ce="">备注</label> <input type=text class=form-control v-model=selectItem.f_remarks _v-4060e2ce=""> </div> </article> <footer slot=modal-footer class=modal-footer _v-4060e2ce=""> <button v-show=show type=button class="btn btn-default" @click=close _v-4060e2ce="">取消</button> <button v-show=show type=button class="btn btn-success" @click=confirm _v-4060e2ce="">确认</button> </footer> </modal> <modal :show.sync=isShow v-ref:modal="" backdrop=false _v-4060e2ce=""> <header slot=modal-header class=modal-header _v-4060e2ce=""> <button type=button class=close @click=closeFile _v-4060e2ce=""><span _v-4060e2ce="">×</span></button> <h4 class=modal-title _v-4060e2ce="">材料导入</h4> </header> <article slot=modal-body class=modal-body _v-4060e2ce=""> <div class=form-group _v-4060e2ce=""> <file-upload class=my-file-uploader name=materialExcel action=rs/file/uploadFile tagname=文件导入 :headers=headers v-ref:file="" _v-4060e2ce=""></file-upload> </div> </article> <footer slot=modal-footer class=modal-footer _v-4060e2ce=""></footer> </modal> '},932:function(e,t,n){var a,s,l={};n(589),a=n(381),s=n(785),e.exports=a||{},e.exports.__esModule&&(e.exports=e.exports.default);var r="function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports;s&&(r.template=s),r.computed||(r.computed={}),Object.keys(l).forEach(function(e){var t=l[e];r.computed[e]=function(){return t}})}});
//# sourceMappingURL=25.js.map