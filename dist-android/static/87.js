webpackJsonp([87],{387:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),i=a(s),o=n(4),r=a(o),c=function(){var e=(0,r.default)(i.default.mark(function e(t,n){var a,s,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="rs/logic/"+n,e.next=3,t.$CancelService.cancel(a,t.model,t.data);case 3:if(s=e.sent,console.log("冲正后的记录。。",s),!t.isNeedEticket(s.data,t.data.type)){e.next=14;break}return console.log("冲正打票，",s.data.id,t.data.type),e.next=9,t.$resetpost("rs/sql/singleTable",{data:{tablename:"t_eticket",condition:"f_sell_id = '"+s.data.id+"' and f_charge_type = '"+t.data.type+"'"}},{resolveMsg:null,rejectMsg:"获取电子票明细失败!!"});case 9:if(o=e.sent,console.log("获取电子票信息",o),!(o.data.length>0)){e.next=14;break}return e.next=14,t.$CommonService.correctEticket(s.data.id,t.data.type);case 14:t.$dispatch("success");case 15:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}();t.default={props:["data"],title:"操作撤销",data:function(){return{model:{f_cancel_reason:"",f_cancel_name:this.$login.f.name,f_filiale:this.$login.f.f_fengongsi,f_outlets:this.$login.f.f_parentname,f_orgstr:this.$login.f.orgpathstr,f_filialeids:this.$login.f.f_orgids,record_id:""}}},methods:{confirm:function(){var e=this.sortdata();console.log("撤销请求业务逻辑名",e),console.log(e),this.post(e),this.$dispatch("searchcard"),this.$dispatch("hiddenbtn")},clean:function(){this.$dispatch("clean",this.model),this.$dispatch("searchcard"),this.$dispatch("hiddenbtn")},sortdata:function(){this.model.record_id=this.data.id;var e=this.data.type,t=void 0;if("过户"===e)t="transferCancel";else if("换表"===e)t="changemeterCancel";else if("机表收费"===e)t="machineChargeCancelPay";else if("物联网收费"===e)t="iotMeterChargeCancel";else if("卡表超用"===e)t="cardOverCancel";else if("超用收费"===e)t="overuseCancel";else if("其他收费"===e)t="otherFeeRollback";else if("补卡"===e)t="replaceCardCancel";else{if("终止报建"!==e)return;t="CancelStopApply"}return t},post:function(e){c(this,e)},isNeedEticket:function(e,t){if("补卡"===t){if(e.f_cardfees>0)return!0}else if("其他收费"===t){if(e.f_collection>0)return!0}else if("超用收费"===t){if(e.f_collection>0)return!0}else if("物联网表收费"===t&&e.f_collection>0)return!0;return!1}}}},815:function(e,t){e.exports=' <div class=auto> <validator name=v> <p class="bg-info text-center" style="padding: 8px">{{data.type}}撤销</p> <div class=row style=margin-top:10px> <div class=form-group> <label for=f_cancel_reason class="col-sm-2 control-label">撤销原因:</label> <div class=col-sm-8> <textarea class=form-control v-model=model.f_cancel_reason rows=3 placeholder=请填写原因></textarea> </div> </div> </div> <div style=text-align:right;height:auto;margin-top:30px;margin-right:50px> <button class="btn btn-success" @click=confirm()>确&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;认</button> <button class="btn btn-default" @click=clean() style=width:80px;margin-left:20px>取&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;消</button> </div> </validator> </div> '},1019:function(e,t,n){var a,s,i={};a=n(387),s=n(815),e.exports=a||{},e.exports.__esModule&&(e.exports=e.exports.default);var o="function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports;s&&(o.template=s),o.computed||(o.computed={}),Object.keys(i).forEach(function(e){var t=i[e];o.computed[e]=function(){return t}})}});
//# sourceMappingURL=87.js.map