{"version":3,"sources":["webpack:///59.js","webpack:///ServiceControl.vue?a083","webpack:///./src/components/product/Process/Processes/Service/ServiceControl.vue?7019","webpack:///./src/components/product/Process/Processes/Service/ServiceControl.vue"],"names":["webpackJsonp","383","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_assign","_assign2","_regenerator","_regenerator2","_stringify","_stringify2","_asyncToGenerator2","_asyncToGenerator3","_vue","_vue2","_vueClient","title","props","data","json_datas","showview","show_data","department_search","methods","special","_x","_ref","apply","this","arguments","mark","_callee","model","http","res","_http","_res","wrap","_context","prev","next","distribute_async","button","button_name","HttpResetClass","load","loginUser","$login","f","resolveMsg","rejectMsg","sent","console","log","stop","refurbish","$workflow_vue","sum","jsonData","i","activitys","length","selectdata","defname","initializtion","$showMessage","_ref2","_callee2","jsonString","jsonArray","_i","j","k","array","_k","temp","_context2","actorexpression","startsWith","push","fields","field","type","options","$appdata","getParam","label","buttons","button_fields","Number","id","name","JSON","parse","f_back_reason","events","select_cascade","index","_x2","_ref3","_callee3","person_name","_context3","abrupt","button_index","tables","start_activity","code","$dispatch","msg","watch","deep","755","934","__vue_script__","__vue_template__","__vue_styles__","__vue_options__","template","computed","keys","forEach","key"],"mappings":"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","file":"59.js","sourcesContent":["webpackJsonp([59],{\n\n/***/ 383:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _assign = __webpack_require__(11);\n\t\n\tvar _assign2 = _interopRequireDefault(_assign);\n\t\n\tvar _regenerator = __webpack_require__(2);\n\t\n\tvar _regenerator2 = _interopRequireDefault(_regenerator);\n\t\n\tvar _stringify = __webpack_require__(6);\n\t\n\tvar _stringify2 = _interopRequireDefault(_stringify);\n\t\n\tvar _asyncToGenerator2 = __webpack_require__(7);\n\t\n\tvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\t\n\tvar _vue = __webpack_require__(1);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _vueClient = __webpack_require__(3);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = {\n\t  title: '报建流程业务控制层',\n\t  props: ['selectdata'],\n\t  data: function data() {\n\t    return {\n\t      data: null,\n\t      json_datas: null,\n\t      showview: false,\n\t      show_data: null,\n\t      department_search: null };\n\t  },\n\t\n\t  methods: {\n\t    special: function () {\n\t      var _ref = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee(model) {\n\t        var http, res, _http, _res;\n\t\n\t        return _regenerator2.default.wrap(function _callee$(_context) {\n\t          while (1) {\n\t            switch (_context.prev = _context.next) {\n\t              case 0:\n\t                if (!(this.data.distribute_async && model.button.button_name === '下发')) {\n\t                  _context.next = 6;\n\t                  break;\n\t                }\n\t\n\t                http = new _vueClient.HttpResetClass();\n\t                _context.next = 4;\n\t                return http.load('POST', 'rs/logic/syncprocess', { data: { model: model, loginUser: this.$login.f } }, { resolveMsg: null, rejectMsg: '流程异步下发据保存失败' });\n\t\n\t              case 4:\n\t                res = _context.sent;\n\t\n\t                console.log(\"流程的异步处理：\", (0, _stringify2.default)(res.data));\n\t\n\t              case 6:\n\t                if (!(this.data.distribute_async && model.button.button_name === '完成')) {\n\t                  _context.next = 12;\n\t                  break;\n\t                }\n\t\n\t                _http = new _vueClient.HttpResetClass();\n\t                _context.next = 10;\n\t                return _http.load('POST', 'rs/logic/stoprocess', { data: { model: model, loginUser: this.$login.f } }, { resolveMsg: null, rejectMsg: '流程异步完成数据保存失败' });\n\t\n\t              case 10:\n\t                _res = _context.sent;\n\t\n\t                console.log(\"流程的异步处理：\", (0, _stringify2.default)(_res.data));\n\t\n\t              case 12:\n\t              case 'end':\n\t                return _context.stop();\n\t            }\n\t          }\n\t        }, _callee, this);\n\t      }));\n\t\n\t      function special(_x) {\n\t        return _ref.apply(this, arguments);\n\t      }\n\t\n\t      return special;\n\t    }(),\n\t    refurbish: function refurbish() {\n\t      this.json_datas = this.$workflow_vue;\n\t      var sum = 0;\n\t      var jsonData = {};\n\t      for (var i = 0; i < this.json_datas.activitys.length; i++) {\n\t        if (this.selectdata.defname == this.json_datas.activitys[i].title) {\n\t          jsonData = this.json_datas.activitys[i];\n\t          sum++;\n\t        }\n\t      }\n\t      if (sum == 1) {\n\t        this.data = null;\n\t        this.data = jsonData;\n\t        this.initializtion();\n\t      } else if (sum == 0) {\n\t        this.$showMessage('\\u6CA1\\u6709\\u5728JSON\\u914D\\u7F6E\\u6587\\u4EF6\\u4E2D\\u627E\\u5230\\u6D3B\\u52A8\\u540D\\u4E3A:(' + this.selectdata.defname + ')\\u7684\\u8282\\u70B9\\u914D\\u7F6E');\n\t      } else {\n\t        this.$showMessage('\\u5728JSON\\u914D\\u7F6E\\u6587\\u4EF6\\u4E2D\\u627E\\u5230\\u6D3B\\u52A8\\u540D\\u4E3A:(' + this.selectdata.defname + ')\\u7684\\u8282\\u70B9\\u914D\\u7F6E:' + sum + '\\u4E2A');\n\t      }\n\t    },\n\t    initializtion: function () {\n\t      var _ref2 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2() {\n\t        var http, res, jsonString, jsonArray, i, _i, j, k, array, _k, temp;\n\t\n\t        return _regenerator2.default.wrap(function _callee2$(_context2) {\n\t          while (1) {\n\t            switch (_context2.prev = _context2.next) {\n\t              case 0:\n\t                if (!this.selectdata.actorexpression) {\n\t                  _context2.next = 10;\n\t                  break;\n\t                }\n\t\n\t                http = new _vueClient.HttpResetClass();\n\t                _context2.next = 4;\n\t                return http.load('POST', 'rs/search', this.selectdata.actorexpression, { resolveMsg: null, rejectMsg: 'search查询部门下所有人失败' });\n\t\n\t              case 4:\n\t                res = _context2.sent;\n\t\n\t                console.log(\"search查询部门下所有人:\", (0, _stringify2.default)(res.data));\n\t                jsonString = (0, _stringify2.default)(res.data);\n\t                jsonArray = [];\n\t\n\t                if (jsonString.startsWith(\"{\")) {\n\t                  jsonArray.push(res.data);\n\t                  res.data = jsonArray;\n\t                }\n\t                this.department_search = res.data;\n\t\n\t              case 10:\n\t                this.data = (0, _assign2.default)({}, this.data, this.selectdata);\n\t\n\t                for (i = 0; i < this.data.fields.length; i++) {\n\t                  if (this.selectdata[this.data.fields[i].field]) {\n\t                    this.data.fields[i].value = this.selectdata[this.data.fields[i].field];\n\t                  }\n\t\n\t                  if (this.data.fields[i].type === 'select') {\n\t                    debugger;\n\t                    this.data.fields[i].options = _vue2.default.$appdata.getParam(this.data.fields[i].label);\n\t                  }\n\t                }\n\t\n\t                for (_i = 0; _i < this.data.buttons.length; _i++) {\n\t\n\t                  if (this.data.buttons[_i].button_fields) {\n\t                    for (j = 0; j < this.data.buttons[_i].button_fields.length; j++) {\n\t                      if (this.selectdata[this.data.buttons[_i].button_fields[j].field]) {\n\t                        this.data.buttons[_i].button_fields[j].value = this.selectdata[this.data.buttons[_i].button_fields[j].field];\n\t                      }\n\t\n\t                      if (this.data.buttons[_i].button_fields[j].type === 'select' && this.$appdata.getParam(this.data.buttons[_i].button_fields[j].label)) {\n\t                        this.data.buttons[_i].button_fields[j].options = this.$appdata.getParam(this.data.buttons[_i].button_fields[j].label);\n\t                      }\n\t\n\t                      if (this.data.buttons[_i].button_name === '下发') {\n\t                        if (this.data.buttons[_i].button_fields.length === 1) {\n\t                          if (this.selectdata[this.data.buttons[_i].button_fields[0].field]) {\n\t                            for (k = 0; k < this.department_search.length; k++) {\n\t                              if (Number(this.department_search[k].id) === Number(this.selectdata[this.data.buttons[_i].button_fields[0].field])) {\n\t                                this.data.buttons[_i].button_fields[0].value = this.department_search[k].name;\n\t                              }\n\t                            }\n\t                          }\n\t\n\t                          if (this.department_search) {\n\t                            array = [];\n\t\n\t                            for (_k = 0; _k < this.department_search.length; _k++) {\n\t                              array.push({ label: this.department_search[_k].name, value: this.department_search[_k].name });\n\t                            }\n\t                            this.data.buttons[_i].button_fields[0].options = array;\n\t                          }\n\t                        } else {\n\t                          this.$showMessage(\"下发按钮必须满足 当且仅当一个字段\");\n\t                        }\n\t                      }\n\t                    }\n\t                  }\n\t                }\n\t                temp = JSON.parse((0, _stringify2.default)(this.data));\n\t\n\t                if (this.selectdata.f_back_reason) {\n\t                  temp['back_reason'] = this.selectdata.f_back_reason;\n\t                }\n\t                this.show_data = temp;\n\t                this.showview = true;\n\t\n\t              case 17:\n\t              case 'end':\n\t                return _context2.stop();\n\t            }\n\t          }\n\t        }, _callee2, this);\n\t      }));\n\t\n\t      function initializtion() {\n\t        return _ref2.apply(this, arguments);\n\t      }\n\t\n\t      return initializtion;\n\t    }()\n\t  },\n\t  events: {\n\t    'select_cascade': function select_cascade(index) {},\n\t    'button': function () {\n\t      var _ref3 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(model) {\n\t        var person_name, i, http, res;\n\t        return _regenerator2.default.wrap(function _callee3$(_context3) {\n\t          while (1) {\n\t            switch (_context3.prev = _context3.next) {\n\t              case 0:\n\t                if (!(model.button.button_name === '重置')) {\n\t                  _context3.next = 3;\n\t                  break;\n\t                }\n\t\n\t                this.initializtion();\n\t                return _context3.abrupt('return');\n\t\n\t              case 3:\n\t                if (model.button.button_name === '下发') {\n\t                  person_name = model.button.button_fields[this.show_data.buttons[model.button.button_index].button_fields[0].field];\n\t\n\t                  for (i = 0; i < this.department_search.length; i++) {\n\t                    if (this.department_search[i].name === person_name) {\n\t                      model.button.button_fields[this.show_data.buttons[model.button.button_index].button_fields[0].field] = this.department_search[i].id;\n\t                    }\n\t                  }\n\t                }\n\t                console.log(\"button事件接收参数：\", model);\n\t                model = (0, _assign2.default)({}, this.selectdata, model);\n\t                http = new _vueClient.HttpResetClass();\n\t                _context3.next = 9;\n\t                return http.load('POST', 'rs/logic/ApplyProductService', { data: { tables: this.data.tables, start_activity: this.$workflow_vue.start_activity, model: model, loginUser: this.$login.f } }, { resolveMsg: null, rejectMsg: '数据保存失败' });\n\t\n\t              case 9:\n\t                res = _context3.sent;\n\t\n\t                console.log(\"service处理完成返回数据：\", (0, _stringify2.default)(res.data));\n\t\n\t                if (!(res.code = 200)) {\n\t                  _context3.next = 18;\n\t                  break;\n\t                }\n\t\n\t                this.showview = false;\n\t\n\t                this.special(model);\n\t                this.$dispatch('close');\n\t                this.initializtion();\n\t                _context3.next = 19;\n\t                break;\n\t\n\t              case 18:\n\t                throw res.data.msg;\n\t\n\t              case 19:\n\t              case 'end':\n\t                return _context3.stop();\n\t            }\n\t          }\n\t        }, _callee3, this);\n\t      }));\n\t\n\t      function button(_x2) {\n\t        return _ref3.apply(this, arguments);\n\t      }\n\t\n\t      return button;\n\t    }()\n\t  },\n\t  watch: {\n\t    'selectdata': function selectdata() {\n\t      this.refurbish();\n\t    },\n\t\n\t    deep: true\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 755:\n/***/ (function(module, exports) {\n\n\tmodule.exports = \" <service-view v-ref:service_show :data=show_data v-if=showview></service-view> \";\n\n/***/ }),\n\n/***/ 934:\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\tvar __vue_styles__ = {}\n\t__vue_script__ = __webpack_require__(383)\n\t__vue_template__ = __webpack_require__(755)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tvar __vue_options__ = typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports\n\tif (__vue_template__) {\n\t__vue_options__.template = __vue_template__\n\t}\n\tif (!__vue_options__.computed) __vue_options__.computed = {}\n\tObject.keys(__vue_styles__).forEach(function (key) {\n\tvar module = __vue_styles__[key]\n\t__vue_options__.computed[key] = function () { return module }\n\t})\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 59.js","<template>\r\n  <service-view v-ref:service_show :data=\"show_data\" v-if=\"showview\"></service-view>\r\n</template>\r\n<script>\r\n  import Vue from 'vue'\r\n  import {HttpResetClass} from 'vue-client'\r\n  export default {\r\n    title: '报建流程业务控制层',\r\n    props: ['selectdata'],\r\n    data () {\r\n      return {\r\n        data:null, // 数据库数据，json配置文件数据的数据集合\r\n        json_datas:null, // Json配置文件集合\r\n        showview:false, // 控制显示service-view组件\r\n        show_data:null, // 给view层显示的数据\r\n        department_search:null // 当前部门下所有人\r\n      }\r\n    },\r\n    methods: {\r\n      // 特殊化处理\r\n      async special(model){\r\n        if(this.data.distribute_async && model.button.button_name==='下发'){\r\n          // 流程异步处理\r\n          let http = new HttpResetClass();\r\n          let res = await http.load('POST','rs/logic/syncprocess',{data:{model:model,loginUser:this.$login.f}}, {resolveMsg: null, rejectMsg: '流程异步下发据保存失败'})\r\n          console.log(\"流程的异步处理：\",JSON.stringify(res.data))\r\n        }\r\n        if(this.data.distribute_async && model.button.button_name==='完成'){\r\n          // 强制结束\r\n          let http = new HttpResetClass();\r\n          let res = await http.load('POST','rs/logic/stoprocess',{data:{model:model,loginUser:this.$login.f}}, {resolveMsg: null, rejectMsg: '流程异步完成数据保存失败'})\r\n          console.log(\"流程的异步处理：\",JSON.stringify(res.data))\r\n        }\r\n      },\r\n      // 组件初始化操作\r\n       refurbish(){\r\n        this.json_datas=this.$workflow_vue\r\n        let sum = 0\r\n        let jsonData ={}\r\n        for(let i=0;i<this.json_datas.activitys.length;i++){\r\n          if(this.selectdata.defname==this.json_datas.activitys[i].title){\r\n            jsonData = this.json_datas.activitys[i]\r\n            sum++\r\n          }\r\n        }\r\n        if(sum==1){\r\n          this.data =null\r\n          this.data = jsonData\r\n          this.initializtion()\r\n        } else if(sum==0) {\r\n          this.$showMessage(`没有在JSON配置文件中找到活动名为:(${this.selectdata.defname})的节点配置`)\r\n        } else {\r\n          this.$showMessage(`在JSON配置文件中找到活动名为:(${this.selectdata.defname})的节点配置:${sum}个`)\r\n        }\r\n      },\r\n      // json配置数据处理 比如下拉框的options\r\n      async initializtion() {\r\n        // 下发人 options 处理，options初始化\r\n        if(this.selectdata.actorexpression){\r\n          let http = new HttpResetClass()\r\n          let res = await http.load('POST','rs/search',this.selectdata.actorexpression, {resolveMsg: null, rejectMsg: 'search查询部门下所有人失败'})\r\n          console.log(\"search查询部门下所有人:\",JSON.stringify(res.data))\r\n          let jsonString = JSON.stringify(res.data)\r\n          let jsonArray = []\r\n          if(jsonString.startsWith(\"{\")){\r\n            jsonArray.push(res.data)\r\n            res.data = jsonArray\r\n          }\r\n          this.department_search = res.data\r\n        }\r\n\r\n        // data 填充 selectdata\r\n        this.data=Object.assign({},this.data,this.selectdata)\r\n\r\n        // 初始化 fields\r\n        for(let i=0;i<this.data.fields.length;i++){\r\n          // 如果selectdata有这些key，则把selectdata的value赋值给data的value\r\n          if(this.selectdata[this.data.fields[i].field]){\r\n            this.data.fields[i].value = this.selectdata[this.data.fields[i].field]\r\n          }\r\n          // 如果配置类型为select,优先从参数列表获取options\r\n          if(this.data.fields[i].type==='select'){\r\n            debugger\r\n            this.data.fields[i].options=Vue.$appdata.getParam(this.data.fields[i].label)\r\n          }\r\n        }\r\n        // 初始化 buttons_fields\r\n        for(let i=0;i<this.data.buttons.length;i++){\r\n\r\n\r\n          if(this.data.buttons[i].button_fields){\r\n            for(let j=0;j<this.data.buttons[i].button_fields.length;j++){\r\n              // 如果selectdata有这些key，则把selectdata的value赋值给data的value\r\n              if(this.selectdata[this.data.buttons[i].button_fields[j].field]){\r\n                this.data.buttons[i].button_fields[j].value = this.selectdata[this.data.buttons[i].button_fields[j].field]\r\n              }\r\n              // 如果配置类型为select,优先从参数列表获取options\r\n              if(this.data.buttons[i].button_fields[j].type==='select'&&this.$appdata.getParam(this.data.buttons[i].button_fields[j].label)){\r\n                this.data.buttons[i].button_fields[j].options=this.$appdata.getParam(this.data.buttons[i].button_fields[j].label)\r\n              }\r\n              // 下发特殊配置\r\n              if(this.data.buttons[i].button_name==='下发'){\r\n                if(this.data.buttons[i].button_fields.length===1){\r\n                  // value初始化\r\n                  // if(this.department_search){\r\n                  if(this.selectdata[this.data.buttons[i].button_fields[0].field]){\r\n                    for(let k=0;k<this.department_search.length;k++){\r\n                      // 将id转换为name\r\n                      if(Number(this.department_search[k].id) === Number(this.selectdata[this.data.buttons[i].button_fields[0].field])){\r\n                        this.data.buttons[i].button_fields[0].value=this.department_search[k].name\r\n                      }\r\n                    }\r\n                  }\r\n\r\n                  if(this.department_search){\r\n                    let array = []\r\n                    for(let k=0;k<this.department_search.length;k++){\r\n                      array.push({label:this.department_search[k].name,value:this.department_search[k].name})\r\n                    }\r\n                    this.data.buttons[i].button_fields[0].options = array\r\n                  }\r\n                }else {\r\n                  this.$showMessage(\"下发按钮必须满足 当且仅当一个字段\")\r\n                }\r\n              }\r\n            }\r\n          }\r\n\r\n        }\r\n        // 消除双向绑定，避免子组件（显示层）数据更改，父组件（控制层）也更改\r\n        let temp = JSON.parse(JSON.stringify(this.data))\r\n        // 退回原因展示\r\n        if(this.selectdata.f_back_reason){\r\n          temp['back_reason'] = this.selectdata.f_back_reason\r\n        }\r\n        this.show_data = temp\r\n        this.showview = true\r\n      }\r\n    },\r\n    events: {\r\n      // 任意select选中时触发事件\r\n      'select_cascade'(index){\r\n        // this.$refs.service_show.model_temp // 子业务显示组件\r\n        // 级联操作示例：\r\n        /*\r\n         if(this.$refs.service_show.model_temp.activitys.ields[index].label==='报建类型'){\r\n          for(let i=0;i<this.$refs.service_show.model_temp.activitys.fields.length;i++){\r\n            // 控制设置级联\r\n            // 源select所选的值 this.$refs.service_show.model_temp.activitys.fields[index].value\r\n            if(this.$refs.service_show.model_temp.activitys.fields[i].label==='级联测试2'){\r\n              this.$refs.service_show.model_temp.activitys.fields[i].options=[\r\n                {label:'级联选项1',value:'级联选项1'},{label:'级联选项2',value:'级联选项2'},{label:'级联选项3',value:'级联选项3'}\r\n              ]\r\n            }\r\n          }\r\n        }\r\n        */\r\n      },\r\n      // 获取view层button事件\r\n      async 'button'(model){\r\n        // 点击重置按钮就重置数据\r\n        if(model.button.button_name==='重置'){\r\n          this.initializtion()\r\n          return\r\n        }\r\n        if(model.button.button_name==='下发'){\r\n           let person_name = model.button.button_fields[this.show_data.buttons[model.button.button_index].button_fields[0].field]\r\n          for(let i=0;i<this.department_search.length;i++){\r\n             // 找到人名为person_name 的人，然后把人名换成id\r\n            if(this.department_search[i].name === person_name){\r\n              model.button.button_fields[this.show_data.buttons[model.button.button_index].button_fields[0].field] = this.department_search[i].id\r\n            }\r\n          }\r\n        }\r\n        console.log(\"button事件接收参数：\",model)\r\n        model=Object.assign({},this.selectdata,model)\r\n        // 下发，提交，保存，退回都在后台处理\r\n        let http = new HttpResetClass()\r\n        let res = await http.load('POST','rs/logic/ApplyProductService',{data:{tables:this.data.tables,start_activity:this.$workflow_vue.start_activity,model:model,loginUser:this.$login.f}}, {resolveMsg: null, rejectMsg: '数据保存失败'})\r\n        console.log(\"service处理完成返回数据：\",JSON.stringify(res.data))\r\n        if(res.code=200){\r\n          this.showview= false\r\n          // 特殊处理\r\n          this.special(model)\r\n          this.$dispatch('close')\r\n          this.initializtion()\r\n        }else{\r\n          throw res.data.msg\r\n        }\r\n      }\r\n    },\r\n    watch:{\r\n      // 监听selectdata的变化\r\n      'selectdata'() {\r\n          this.refurbish()\r\n      },\r\n      deep:true\r\n    }\r\n  }\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// ServiceControl.vue?4b343e34","module.exports = \" <service-view v-ref:service_show :data=show_data v-if=showview></service-view> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-html-loader!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/product/Process/Processes/Service/ServiceControl.vue\n// module id = 755\n// module chunks = 59","var __vue_script__, __vue_template__\nvar __vue_styles__ = {}\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!../../../../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./ServiceControl.vue\")\n__vue_template__ = require(\"!!vue-html-loader!../../../../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./ServiceControl.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue_options__ = typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports\nif (__vue_template__) {\n__vue_options__.template = __vue_template__\n}\nif (!__vue_options__.computed) __vue_options__.computed = {}\nObject.keys(__vue_styles__).forEach(function (key) {\nvar module = __vue_styles__[key]\n__vue_options__.computed[key] = function () { return module }\n})\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/product/Process/Processes/Service/ServiceControl.vue\n// module id = 934\n// module chunks = 59"],"sourceRoot":""}