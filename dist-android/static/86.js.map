{"version":3,"sources":["webpack:///86.js","webpack:///InstallFee.vue","webpack:///./src/components/product/Function/functions/InstallFee.vue?2d45","webpack:///./src/components/product/Function/functions/InstallFee.vue"],"names":["webpackJsonp","388","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","Object","defineProperty","value","_asyncToGenerator2","_asyncToGenerator3","_regenerator","_regenerator2","_vueClient","_InputAndSelect","_InputAndSelect2","mark","gen","self","val","wrap","_context","prev","next","f_actualfee_type","f_bill_type","$resetpost","data","tablename","parameters","id","then","reset","stop","this","components","InputAndSelect","title","showpay","addItem","model","subcost","f_total_cost","f_payfee_operator","f_payfee_department","f_filiale","f_payfee_date","f_cumulative_money","f_unaccounts_money","f_cumulative_invoicing","f_residual_invoicing","f_main_contract_num","rows","f_payment_type","label","chargemoney","props","ready","load","$login","f","name","f_parentname","f_fengongsi","toStandardDateString","methods","check","console","log","re","f_charge_money","test","$showMessage","change","f_charge_remarks","infee","f_account_cost","f_construction_cost","f_material_cost","f_labor_cost","f_change_pipeline_cost","f_sbaz_cost","smalltoBIG","n","fraction","digit","unit","head","Math","abs","s","i","length","floor","pow","replace","p","j","add","close","confirm","_ref","apply","arguments","_callee","flag","flag1","flag2","http","_this","_context2","abrupt","Number","accAdd","accSub","f_payment_typed","HttpResetClass","f_amount_words","f_charge_collectors","f_charge_date","f_process_id","push","f_charging_status","resolveMsg","rejectMsg","res","f_apply_num","invoiceInterface","_flag","_flag2","_data","f_invoice_num","goback","invoice","_ref2","_callee2","_this2","_context3","$dispatch","showview","tovoid","_x","_ref3","_callee3","correctionInterface","flag3","flag4","_this3","_context4","f_is_correct","condition","sent","tomakeup","arg1","arg2","r1","r2","m","toString","split","e","max","toFixed","_ref4","_callee4","_context5","columnname","f_contract_money","substring","f_contract_number","computed","getCapital","feeoptions","$appdata","getParam","dayin","jiaofei","816","1020","__vue_script__","__vue_template__","__vue_styles__","__vue_options__","options","template","keys","forEach","key"],"mappings":"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","file":"86.js","sourcesContent":["webpackJsonp([86],{\n\n/***/ 388:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _asyncToGenerator2 = __webpack_require__(4);\n\t\n\tvar _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);\n\t\n\tvar _regenerator = __webpack_require__(2);\n\t\n\tvar _regenerator2 = _interopRequireDefault(_regenerator);\n\t\n\tvar _vueClient = __webpack_require__(3);\n\t\n\tvar _InputAndSelect = __webpack_require__(76);\n\t\n\tvar _InputAndSelect2 = _interopRequireDefault(_InputAndSelect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar gen = _regenerator2.default.mark(function gen(self, val) {\n\t  return _regenerator2.default.wrap(function gen$(_context) {\n\t    while (1) {\n\t      switch (_context.prev = _context.next) {\n\t        case 0:\n\t          val.f_actualfee_type = val.f_actualfee_type[0];\n\t          val.f_bill_type = val.f_bill_type[0];\n\t          _context.next = 4;\n\t          return self.$resetpost('rs/logic/saveentity', { data: { tablename: 't_apply', parameters: val } });\n\t\n\t        case 4:\n\t          delete val.id;\n\t          self.$resetpost('rs/logic/saveentity', { data: { tablename: 't_record', parameters: val } }).then(function () {\n\t            self.reset();\n\t          });\n\t\n\t        case 6:\n\t        case 'end':\n\t          return _context.stop();\n\t      }\n\t    }\n\t  }, gen, this);\n\t});\n\texports.default = {\n\t  components: { InputAndSelect: _InputAndSelect2.default },\n\t  title: '报装收费',\n\t  data: function data() {\n\t    return {\n\t      showpay: false,\n\t      addItem: null,\n\t      model: {\n\t        subcost: 0,\n\t        f_total_cost: 0,\n\t        f_payfee_operator: '',\n\t        f_payfee_department: '',\n\t        f_filiale: '',\n\t        f_payfee_date: '',\n\t        f_cumulative_money: 0,\n\t        f_unaccounts_money: '',\n\t        f_cumulative_invoicing: '',\n\t        f_residual_invoicing: '',\n\t        f_main_contract_num: 0,\n\t        rows: [] },\n\t      f_payment_type: [{ label: '分期', value: '分期' }, { label: '一次付清', value: '一次付清' }],\n\t      chargemoney: 0\n\t    };\n\t  },\n\t\n\t  props: ['infee'],\n\t  ready: function ready() {\n\t    this.load();\n\t    this.model.f_payfee_operator = this.$login.f.name;\n\t    this.model.f_payfee_department = this.$login.f.f_parentname;\n\t    this.model.f_filiale = this.$login.f.f_fengongsi;\n\t    this.model.f_payfee_date = this.$login.toStandardDateString();\n\t  },\n\t\n\t  methods: {\n\t    check: function check() {\n\t      console.log('check');\n\t      var re = /^[+-]?\\d+(\\.\\d+)?$/;\n\t      if (!this.addItem.f_charge_money) {\n\t        console.log('check1');\n\t        this.addItem.f_charge_money = this.model.f_unaccounts_money;\n\t      } else {\n\t        if (!re.test(this.addItem.f_charge_money)) {\n\t          this.$showMessage(\"请输入数字\");\n\t          this.addItem.f_charge_money = '';\n\t          return false;\n\t        }\n\t      }\n\t\n\t      return true;\n\t    },\n\t    change: function change() {\n\t      if (this.addItem.f_charge_remarks === '开户费') {\n\t        this.addItem.f_charge_money = this.infee.f_account_cost ? this.infee.f_account_cost : 0;\n\t      }\n\t      if (this.addItem.f_charge_remarks === '入户安装费') {\n\t        this.addItem.f_charge_money = this.infee.f_construction_cost ? this.infee.f_construction_cost : 0;\n\t      }\n\t      if (this.addItem.f_charge_remarks === '材料费') {\n\t        this.addItem.f_charge_money = this.infee.f_material_cost ? this.infee.f_material_cost : 0;\n\t      }\n\t      if (this.addItem.f_charge_remarks === '人工费') {\n\t        this.addItem.f_charge_money = this.infee.f_labor_cost ? this.infee.f_labor_cost : 0;\n\t      }\n\t      if (this.addItem.f_charge_remarks === '改管费') {\n\t        this.addItem.f_charge_money = this.infee.f_change_pipeline_cost ? this.infee.f_change_pipeline_cost : 0;\n\t      }\n\t      if (this.addItem.f_charge_remarks === '设备安装费') {\n\t        this.addItem.f_charge_money = this.infee.f_sbaz_cost ? this.infee.f_sbaz_cost : 0;\n\t      }\n\t    },\n\t    smalltoBIG: function smalltoBIG(n) {\n\t      var fraction = ['角', '分'];\n\t      var digit = ['零', '壹', '贰', '叁', '肆', '伍', '陆', '柒', '捌', '玖'];\n\t      var unit = [['元', '万', '亿'], ['', '拾', '佰', '仟']];\n\t      var head = n < 0 ? '欠' : '';\n\t      n = Math.abs(n);\n\t\n\t      var s = '';\n\t\n\t      for (var i = 0; i < fraction.length; i++) {\n\t        s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');\n\t      }\n\t      s = s || '整';\n\t      n = Math.floor(n);\n\t\n\t      for (var i = 0; i < unit[0].length && n > 0; i++) {\n\t        var p = '';\n\t        for (var j = 0; j < unit[1].length && n > 0; j++) {\n\t          p = digit[n % 10] + unit[1][j] + p;\n\t          n = Math.floor(n / 10);\n\t        }\n\t        s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;\n\t      }\n\t      return head + s.replace(/(零.)*零元/, '元').replace(/(零.)+/g, '零').replace(/^整$/, '零元整');\n\t    },\n\t    add: function add() {\n\t      this.addItem = null;\n\t      this.showpay = true;\n\t    },\n\t    close: function close() {\n\t      this.showpay = false;\n\t      this.addItem = null;\n\t    },\n\t    confirm: function () {\n\t      var _ref = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee() {\n\t        var _this = this;\n\t\n\t        var flag, flag1, flag2, http, chargemoney, data;\n\t        return _regenerator2.default.wrap(function _callee$(_context2) {\n\t          while (1) {\n\t            switch (_context2.prev = _context2.next) {\n\t              case 0:\n\t                flag = this.check();\n\t\n\t                if (flag) {\n\t                  _context2.next = 3;\n\t                  break;\n\t                }\n\t\n\t                return _context2.abrupt('return');\n\t\n\t              case 3:\n\t\n\t                console.log('f_charge_money' + Number(this.addItem.f_charge_money));\n\t                console.log('f_unaccounts_money' + Number(this.model.f_unaccounts_money));\n\t\n\t                if (!(Number(this.addItem.f_charge_money) > Number(this.model.f_unaccounts_money))) {\n\t                  _context2.next = 9;\n\t                  break;\n\t                }\n\t\n\t                this.$showMessage(\"缴费金额不能大于剩余金额\");\n\t                _context2.next = 39;\n\t                break;\n\t\n\t              case 9:\n\t                if (!(this.addItem.f_charge_money == 0)) {\n\t                  _context2.next = 13;\n\t                  break;\n\t                }\n\t\n\t                this.$showMessage(\"不能缴费0元\");\n\t                _context2.next = 39;\n\t                break;\n\t\n\t              case 13:\n\t                flag1 = this.accAdd(Number(this.addItem.f_charge_money), Number(this.model.f_cumulative_money));\n\t                flag2 = this.accSub(Number(this.model.f_unaccounts_money), Number(this.addItem.f_charge_money));\n\t\n\t\n\t                if (this.addItem.f_payment_typed == '') {\n\t                  this.addItem.f_payment_typed = '分期';\n\t                  console.log('为空');\n\t                }\n\t\n\t                http = new _vueClient.HttpResetClass();\n\t\n\t\n\t                this.addItem.f_charge_money = this.addItem.f_charge_money;\n\t                this.addItem.f_amount_words = this.addItem.f_amount_words;\n\t\n\t                this.addItem.f_charge_collectors = this.$login.f.name;\n\t                this.addItem.f_charge_date = this.addItem.f_charge_date;\n\t                this.addItem.f_charge_remarks = this.addItem.f_charge_remarks;\n\t                this.addItem.f_filiale = this.$login.f.f_fengongsi;\n\t                this.addItem.f_process_id = this.infee.f_process_id;\n\t                this.model.rows.push(this.addItem);\n\t                this.addItem.f_charging_status = '有效';\n\t                chargemoney = this.addItem.f_charge_money;\n\t\n\t                this.chargemoney = this.addItem.f_charge_money;\n\t                data = {\n\t                  tablename: 't_charge_record',\n\t                  parameters: this.addItem\n\t                };\n\t                _context2.next = 31;\n\t                return http.load('POST', 'rs/logic/saveentity', { data: data }, { resolveMsg: null, rejectMsg: \"添加失败\" }).then(function (res) {\n\t                  _this.close();\n\t                });\n\t\n\t              case 31:\n\t\n\t                data = {\n\t                  f_cumulative_money: flag1,\n\t                  f_unaccounts_money: flag2,\n\t                  f_apply_num: this.infee.f_apply_num\n\t                };\n\t                _context2.next = 34;\n\t                return http.load('POST', 'rs/logic/updatechargemoney', { data: data }, { resolveMsg: null, rejectMsg: \"添加累计金额失败\" }).then(function (res) {\n\t                  _this.close();\n\t                  _this.load();\n\t                });\n\t\n\t              case 34:\n\t                console.log(this.model.f_cumulative_invoicing);\n\t                console.log(chargemoney);\n\t                console.log(this.model.f_cumulative_invoicing);\n\t                console.log(this.model.f_residual_invoicing);\n\t                this.$showMessage('是否打票据', ['confirm', 'cancel']).then(function (res) {\n\t                  if (res === 'confirm') {\n\t                    console.log('打印票据');\n\t                    var invoiceInterface = true;\n\t                    var _flag = _this.accAdd(Number(chargemoney), Number(_this.model.f_cumulative_invoicing));\n\t                    var _flag2 = _this.accSub(Number(_this.model.f_residual_invoicing), Number(chargemoney));\n\t                    if (invoiceInterface) {\n\t                      var _data = {\n\t                        f_cumulative_invoicing: _flag,\n\t                        f_residual_invoicing: _flag2,\n\t                        f_apply_num: _this.infee.f_apply_num,\n\t                        f_invoice_num: '123' };\n\t                      http.load('POST', 'rs/logic/updateinvoicemoney', { data: _data }, {\n\t                        resolveMsg: null,\n\t                        rejectMsg: \"修改开票金额失败\"\n\t                      }).then(function (res) {\n\t                        _this.close();\n\t                        _this.load();\n\t                      });\n\t                    } else {\n\t                      _this.$showMessage('开发票失败');\n\t                    }\n\t                  } else {\n\t                    _this.goback();\n\t                  }\n\t                });\n\t\n\t              case 39:\n\t              case 'end':\n\t                return _context2.stop();\n\t            }\n\t          }\n\t        }, _callee, this);\n\t      }));\n\t\n\t      function confirm() {\n\t        return _ref.apply(this, arguments);\n\t      }\n\t\n\t      return confirm;\n\t    }(),\n\t    invoice: function () {\n\t      var _ref2 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee2() {\n\t        var _this2 = this;\n\t\n\t        var http, invoiceInterface, flag1, flag2, data;\n\t        return _regenerator2.default.wrap(function _callee2$(_context3) {\n\t          while (1) {\n\t            switch (_context3.prev = _context3.next) {\n\t              case 0:\n\t                console.log('打印票据');\n\t                http = new _vueClient.HttpResetClass();\n\t                invoiceInterface = true;\n\t                flag1 = this.accAdd(Number(this.chargemoney), Number(this.model.f_cumulative_invoicing));\n\t                flag2 = this.accSub(Number(this.model.f_residual_invoicing), Number(this.chargemoney));\n\t\n\t                if (!invoiceInterface) {\n\t                  _context3.next = 11;\n\t                  break;\n\t                }\n\t\n\t                data = {\n\t                  f_cumulative_invoicing: flag1,\n\t                  f_residual_invoicing: flag2,\n\t                  f_apply_num: this.infee.f_apply_num,\n\t                  f_invoice_num: '123' };\n\t                _context3.next = 9;\n\t                return http.load('POST', 'rs/logic/updateinvoicemoney', { data: data }, {\n\t                  resolveMsg: null,\n\t                  rejectMsg: \"修改开票金额失败\"\n\t                }).then(function (res) {\n\t                  _this2.close();\n\t                  _this2.load();\n\t                });\n\t\n\t              case 9:\n\t                _context3.next = 12;\n\t                break;\n\t\n\t              case 11:\n\t                this.$showMessage('开发票失败');\n\t\n\t              case 12:\n\t              case 'end':\n\t                return _context3.stop();\n\t            }\n\t          }\n\t        }, _callee2, this);\n\t      }));\n\t\n\t      function invoice() {\n\t        return _ref2.apply(this, arguments);\n\t      }\n\t\n\t      return invoice;\n\t    }(),\n\t    goback: function goback() {\n\t      this.$dispatch('hiddenbtn');\n\t      this.showview = false;\n\t    },\n\t    tovoid: function () {\n\t      var _ref3 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee3(val) {\n\t        var _this3 = this;\n\t\n\t        var correctionInterface, http, data, res, flag1, flag2, flag3, flag4;\n\t        return _regenerator2.default.wrap(function _callee3$(_context4) {\n\t          while (1) {\n\t            switch (_context4.prev = _context4.next) {\n\t              case 0:\n\t                if (!(val.f_is_correct === '是')) {\n\t                  _context4.next = 4;\n\t                  break;\n\t                }\n\t\n\t                this.$showMessage('已冲正过，不能操作！');\n\t                _context4.next = 21;\n\t                break;\n\t\n\t              case 4:\n\t                correctionInterface = true;\n\t\n\t                if (!correctionInterface) {\n\t                  _context4.next = 20;\n\t                  break;\n\t                }\n\t\n\t                http = new _vueClient.HttpResetClass();\n\t                data = {\n\t                  tablename: 't_charge_record',\n\t                  condition: 'id = \\'' + val.id + '\\''\n\t                };\n\t                _context4.next = 10;\n\t                return http.load('POST', 'rs/sql/singleTable', { data: data }, {\n\t                  resolveMsg: null,\n\t                  rejectMsg: '获取付款数据失败'\n\t                });\n\t\n\t              case 10:\n\t                res = _context4.sent;\n\t                flag1 = this.accSub(Number(this.model.f_cumulative_money), Number(val.f_charge_money));\n\t                flag2 = this.accAdd(Number(this.model.f_unaccounts_money), Number(val.f_charge_money));\n\t                flag3 = Number(this.model.f_cumulative_invoicing);\n\t                flag4 = Number(this.model.f_residual_invoicing);\n\t\n\t                if (res.data[0].f_invoice_num) {\n\t                  flag3 = this.accSub(Number(this.model.f_cumulative_invoicing), Number(val.f_charge_money));\n\t                  flag4 = this.accAdd(Number(this.model.f_residual_invoicing), Number(val.f_charge_money));\n\t                }\n\t                data = {\n\t                  f_cumulative_money: flag1,\n\t                  f_unaccounts_money: flag2,\n\t                  f_cumulative_invoicing: flag3,\n\t                  f_residual_invoicing: flag4,\n\t                  f_apply_num: this.infee.f_apply_num,\n\t                  id: val.id\n\t                };\n\t                this.$resetpost('rs/logic/tovoidcharge', data, { resolveMsg: '冲正成功', rejectMsg: '冲正失败' }).then(function (res) {\n\t                  _this3.load();\n\t                });\n\t                _context4.next = 21;\n\t                break;\n\t\n\t              case 20:\n\t                this.$showMessage('冲正接口调用失败！');\n\t\n\t              case 21:\n\t              case 'end':\n\t                return _context4.stop();\n\t            }\n\t          }\n\t        }, _callee3, this);\n\t      }));\n\t\n\t      function tovoid(_x) {\n\t        return _ref3.apply(this, arguments);\n\t      }\n\t\n\t      return tovoid;\n\t    }(),\n\t    tomakeup: function tomakeup(val) {\n\t      if (val.f_invoice_num) {\n\t        this.$showMessage('此记录有票据,不能操作！');\n\t      } else {\n\t        this.invoice();\n\t      }\n\t    },\n\t    accSub: function accSub(arg1, arg2) {\n\t      var r1, r2, m, n;\n\t      try {\n\t        r1 = arg1.toString().split(\".\")[1].length;\n\t      } catch (e) {\n\t        r1 = 0;\n\t      }\n\t      try {\n\t        r2 = arg2.toString().split(\".\")[1].length;\n\t      } catch (e) {\n\t        r2 = 0;\n\t      }\n\t      m = Math.pow(10, Math.max(r1, r2));\n\t\n\t      n = r1 >= r2 ? r1 : r2;\n\t      return ((arg1 * m - arg2 * m) / m).toFixed(n);\n\t    },\n\t    reset: function reset() {\n\t      this.$dispatch('close');\n\t      this.$dispatch('selfsearch');\n\t    },\n\t    accAdd: function accAdd(arg1, arg2) {\n\t      var r1, r2, m;\n\t      try {\n\t        r1 = arg1.toString().split(\".\")[1].length;\n\t      } catch (e) {\n\t        r1 = 0;\n\t      }\n\t      try {\n\t        r2 = arg2.toString().split(\".\")[1].length;\n\t      } catch (e) {\n\t        r2 = 0;\n\t      }\n\t      m = Math.pow(10, Math.max(r1, r2));\n\t      return (arg1 * m + arg2 * m) / m;\n\t    },\n\t    load: function () {\n\t      var _ref4 = (0, _asyncToGenerator3.default)(_regenerator2.default.mark(function _callee4() {\n\t        var http, data, res, i;\n\t        return _regenerator2.default.wrap(function _callee4$(_context5) {\n\t          while (1) {\n\t            switch (_context5.prev = _context5.next) {\n\t              case 0:\n\t                http = new _vueClient.HttpResetClass();\n\t                data = {\n\t                  columnname: 'f_contract_money',\n\t                  tablename: 't_contract',\n\t                  condition: 'processid = \\'' + this.infee.f_process_id + '\\''\n\t                };\n\t                _context5.next = 4;\n\t                return http.load('POST', 'rs/sql/getSum', { data: data }, { resolveMsg: null, rejectMsg: '获取总金额失败' });\n\t\n\t              case 4:\n\t                res = _context5.sent;\n\t\n\t                this.model.f_total_cost = res.data[0].f_contract_money;\n\t                data = {\n\t                  tablename: 't_charge_record',\n\t                  condition: 'f_process_id = \\'' + this.infee.f_process_id + '\\''\n\t                };\n\t\n\t                _context5.next = 9;\n\t                return http.load('POST', 'rs/sql/singleTable', { data: data }, { resolveMsg: null, rejectMsg: '获取付款数据失败' });\n\t\n\t              case 9:\n\t                res = _context5.sent;\n\t\n\t                for (i = 0; i < res.data.length; i++) {\n\t                  res.data[i].f_charge_date = res.data[i].f_charge_date.substring(0, 11);\n\t                }\n\t                this.model.rows = res.data;\n\t\n\t                data = {\n\t                  tablename: 't_contract',\n\t                  condition: 'processid = \\'' + this.infee.f_process_id + '\\''\n\t                };\n\t\n\t                _context5.next = 15;\n\t                return http.load('POST', 'rs/sql/singleTable', { data: data }, { resolveMsg: null, rejectMsg: '获取主合同编号失败' });\n\t\n\t              case 15:\n\t                res = _context5.sent;\n\t\n\t                for (i = 0; i < res.data.length; i++) {\n\t                  if (res.data[i].f_contract_number) {\n\t                    this.model.f_main_contract_num = res.data[i].f_contract_number;\n\t                  }\n\t                }\n\t\n\t                data = {\n\t                  tablename: 't_apply',\n\t                  condition: 'f_apply_num = \\'' + this.infee.f_apply_num + '\\''\n\t                };\n\t\n\t                _context5.next = 20;\n\t                return http.load('POST', 'rs/sql/singleTable', { data: data }, { resolveMsg: null, rejectMsg: '获取累计数据失败' });\n\t\n\t              case 20:\n\t                res = _context5.sent;\n\t\n\t                this.model.f_cumulative_money = Number(res.data[0].f_cumulative_money);\n\t                this.model.chargemoney = Number(res.data[0].f_cumulative_money);\n\t                this.model.f_unaccounts_money = Number(res.data[0].f_unaccounts_money);\n\t                this.model.f_cumulative_invoicing = Number(res.data[0].f_cumulative_invoicing);\n\t                this.model.f_residual_invoicing = Number(res.data[0].f_residual_invoicing);\n\t\n\t              case 26:\n\t              case 'end':\n\t                return _context5.stop();\n\t            }\n\t          }\n\t        }, _callee4, this);\n\t      }));\n\t\n\t      function load() {\n\t        return _ref4.apply(this, arguments);\n\t      }\n\t\n\t      return load;\n\t    }()\n\t  },\n\t  computed: {\n\t    getCapital: function getCapital() {\n\t      if (this.addItem.f_charge_money) {\n\t        this.addItem.f_amount_words = this.smalltoBIG(Number(this.addItem.f_charge_money));\n\t      }\n\t\n\t      return this.addItem.f_amount_words;\n\t    },\n\t    feeoptions: function feeoptions() {\n\t      return this.$appdata.getParam('费用类型');\n\t    },\n\t    dayin: function dayin() {\n\t      return this.$appdata.getParam('打印格式');\n\t    },\n\t    jiaofei: function jiaofei() {\n\t      return this.$appdata.getParam('缴费类型');\n\t    }\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 816:\n/***/ (function(module, exports) {\n\n\tmodule.exports = \" <div class=\\\"col-sm-12 auto select-overspread\\\"> <div class=\\\"auto select-overspread\\\"> <div class=\\\"panel panel-info\\\"> <div class=\\\"panel-heading auto\\\"> <h3 class=panel-title>报装收费</h3> </div> </div> </div> <div class=col-sm-12> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">合同编号:{{model.f_main_contract_num}}</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">合同总金额:{{model.f_total_cost}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">累计缴费金额:{{model.f_cumulative_money}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">未结总金额:{{model.f_unaccounts_money}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">累计开票金额:{{model.f_cumulative_invoicing}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">未开票金额:{{model.f_residual_invoicing}}元</span> <button type=button class=\\\"btn btn-warning col-sm-2\\\" @click=add()>新增收费</button> </div> <div class=col-sm-12 style=\\\"height: auto\\\"> <div class=\\\"form-inline auto\\\" style=\\\"margin-bottom: 5px\\\"> </div> <div class=\\\"col-sm-12 span recordTable\\\" style=\\\"margin-top: 10px;min-height: 350px\\\"> <partial-view v-ref:single-load> <data-grid :model=model v-ref:grid> <template partial=head> <tr> <th>序号</th> <th>收费金额(元)</th> <th>金额大写</th> <th>缴费类型</th> <th>收费人员</th> <th>状态</th> <th>日期</th> <th>备注</th> <th>操作</th> </tr> </template> <template partial=body> <td style=\\\"text-align: center\\\">{{$index+1}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_money}}</td> <td style=\\\"text-align: center\\\">{{row.f_amount_words}}</td> <td style=\\\"text-align: center\\\">{{row.f_payment_type}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_collectors}}</td> <td style=\\\"text-align: center\\\">{{row.f_charging_status}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_date}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_remarks}}</td> <td class=flex-around> <button type=button name=button class=\\\"btn btn-link\\\" @click.stop=$parent.$parent.$parent.tomakeup(row)>补开票据 </button> <button type=button name=button class=\\\"btn btn-link\\\" @click.stop=$parent.$parent.$parent.tovoid(row)>冲正 </button> </td> </template> </data-grid> </partial-view> </div> </div> <div class=\\\"form-group col-sm-12\\\"> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">分公司：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_filiale disabled=disabled> </div> </div> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">操作日期：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_payfee_date disabled=disabled> </div> </div> </div> <div class=\\\"form-group col-sm-12\\\"> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">部门：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_payfee_department disabled=disabled> </div> </div> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">操作人：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_payfee_operator disabled=disabled> </div> </div> </div> <modal :show.sync=showpay v-ref:modal backdrop=false> <header slot=modal-header class=modal-header> <button type=button class=close @click=close><span>&times;</span></button> <h4 class=modal-title>新增收费</h4> </header> <article slot=modal-body class=modal-body> <div v-if=showpay> <div class=from-group> <label>合同总金额(元)</label> <input type=text class=form-control v-model=model.f_total_cost readonly=readonly> </div> <div class=from-group> <label>累计缴费金额(元)</label> <input type=text class=form-control v-model=model.f_cumulative_money readonly=readonly> </div> <div class=from-group> <label>未结总金额(元)</label> <input type=text class=form-control v-model=model.f_unaccounts_money readonly=readonly> </div> <div class=from-group> <label>金额(元)</label> <input type=text :placeholder=model.f_unaccounts_money class=form-control v-model=addItem.f_charge_money @blur=check()> </div> <div class=from-group> <label>金额大写</label> <input type=text class=form-control v-model=getCapital readonly=readonly> </div> <div class=from-group> <label>交费日期</label> <div> <datepicker width=600.76px; :value.sync=addItem.f_charge_date :format=\\\"'yyyy-MM-dd'\\\" v-model=addItem.f_charge_date readonly=readonly :show-reset-button=reset> </datepicker> </div> </div> <div class=from-group> <label>备注</label> <input type=text class=form-control v-model=addItem.f_charge_remarks> </div> </div> </article> <footer slot=modal-footer class=modal-footer> <button v-show=showpay type=button class=\\\"btn btn-default\\\" @click=close>取消</button> <button v-show=showpay type=button class=\\\"btn btn-success\\\" @click=confirm>确认</button> </footer> </modal> </div> \";\n\n/***/ }),\n\n/***/ 1020:\n/***/ (function(module, exports, __webpack_require__) {\n\n\tvar __vue_script__, __vue_template__\n\tvar __vue_styles__ = {}\n\t__vue_script__ = __webpack_require__(388)\n\t__vue_template__ = __webpack_require__(816)\n\tmodule.exports = __vue_script__ || {}\n\tif (module.exports.__esModule) module.exports = module.exports.default\n\tvar __vue_options__ = typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports\n\tif (__vue_template__) {\n\t__vue_options__.template = __vue_template__\n\t}\n\tif (!__vue_options__.computed) __vue_options__.computed = {}\n\tObject.keys(__vue_styles__).forEach(function (key) {\n\tvar module = __vue_styles__[key]\n\t__vue_options__.computed[key] = function () { return module }\n\t})\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// 86.js","<template>\r\n  <div class=\"col-sm-12 auto select-overspread\">\r\n    <div class=\"auto select-overspread\">\r\n      <div class=\"panel panel-info\">\r\n        <div class=\"panel-heading auto\">\r\n          <h3 class=\"panel-title\">报装收费</h3>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"col-sm-12\">\r\n      <span class=\"col-sm-3\" v-show=\"!($login.f.f_fengongsi.includes('彩虹'))\">合同编号:{{model.f_main_contract_num}}</span>\r\n      <!--<span class=\"col-sm-3\" v-show=\"!($login.f.f_fengongsi.includes('彩虹'))\">缴费类型(未定):{{}}元</span>-->\r\n      <span class=\"col-sm-3\" v-show=\"!($login.f.f_fengongsi.includes('彩虹'))\">合同总金额:{{model.f_total_cost}}元</span>\r\n      <span class=\"col-sm-3\" v-show=\"!($login.f.f_fengongsi.includes('彩虹'))\">累计缴费金额:{{model.f_cumulative_money}}元</span>\r\n      <span class=\"col-sm-3\" v-show=\"!($login.f.f_fengongsi.includes('彩虹'))\">未结总金额:{{model.f_unaccounts_money}}元</span>\r\n      <span class=\"col-sm-3\"\r\n            v-show=\"!($login.f.f_fengongsi.includes('彩虹'))\">累计开票金额:{{model.f_cumulative_invoicing}}元</span>\r\n      <span class=\"col-sm-3\"\r\n            v-show=\"!($login.f.f_fengongsi.includes('彩虹'))\">未开票金额:{{model.f_residual_invoicing}}元</span>\r\n      <button type=\"button\" class=\"btn btn-warning col-sm-2\" @click=\"add()\">新增收费</button>\r\n    </div>\r\n    <div class=\"col-sm-12\" style=\"height: auto\">\r\n      <div class=\"form-inline auto\" style=\"margin-bottom: 5px;\">\r\n      </div>\r\n      <div class=\"col-sm-12 span recordTable\" style=\"margin-top: 10px;min-height: 350px\">\r\n        <partial-view v-ref:single-load>\r\n          <data-grid :model=\"model\" v-ref:grid>\r\n            <template partial='head'>\r\n              <tr>\r\n                <th>序号</th>\r\n                <th>收费金额(元)</th>\r\n                <th>金额大写</th>\r\n                <th>缴费类型</th>\r\n                <th>收费人员</th>\r\n                <th>状态</th>\r\n                <th>日期</th>\r\n                <th>备注</th>\r\n                <th>操作</th>\r\n              </tr>\r\n            </template>\r\n            <template partial='body'>\r\n              <td style=\"text-align: center\">{{$index+1}}</td>\r\n              <td style=\"text-align: center\">{{row.f_charge_money}}</td>\r\n              <td style=\"text-align: center\">{{row.f_amount_words}}</td>\r\n              <td style=\"text-align: center\">{{row.f_payment_type}}</td>\r\n              <td style=\"text-align: center\">{{row.f_charge_collectors}}</td>\r\n              <td style=\"text-align: center\">{{row.f_charging_status}}</td>\r\n              <td style=\"text-align: center\">{{row.f_charge_date}}</td>\r\n              <td style=\"text-align: center\">{{row.f_charge_remarks}}</td>\r\n              <td class=\"flex-around\">\r\n                <button type=\"button\" name=\"button\" class=\"btn btn-link\"\r\n                        @click.stop=\"$parent.$parent.$parent.tomakeup(row)\">补开票据\r\n                </button>\r\n                <button type=\"button\" name=\"button\" class=\"btn btn-link\"\r\n                        @click.stop=\"$parent.$parent.$parent.tovoid(row)\">冲正\r\n                </button>\r\n              </td>\r\n            </template>\r\n          </data-grid>\r\n        </partial-view>\r\n      </div>\r\n    </div>\r\n\r\n    <!--<div class=\"form-group col-sm-12\">-->\r\n    <!--<div class=\"col-sm-2\">-->\r\n    <!--<label class=\"control-label col-sm-12\">收费备注：</label>-->\r\n    <!--</div>-->\r\n    <!--<div class=\"col-sm-10\">-->\r\n    <!--<textarea class=\"form-control\" rows=\"3\" v-model=\"model.f_payfee_remarks\"></textarea>-->\r\n    <!--</div>-->\r\n    <!--</div>-->\r\n    <div class=\"form-group col-sm-12\">\r\n      <div class=\"col-sm-6\">\r\n        <label class=\"control-label col-sm-4\">分公司：</label>\r\n        <div class=\"col-sm-8\">\r\n          <input class=\"form-control\" type=\"text\" v-model=\"model.f_filiale\" disabled>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-sm-6\">\r\n        <label class=\"control-label col-sm-4\">操作日期：</label>\r\n        <div class=\"col-sm-8\">\r\n          <input class=\"form-control\" type=\"text\" v-model=\"model.f_payfee_date\" disabled>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"form-group col-sm-12\">\r\n      <div class=\"col-sm-6\">\r\n        <label class=\"control-label col-sm-4\">部门：</label>\r\n        <div class=\"col-sm-8\">\r\n          <input class=\"form-control\" type=\"text\" v-model=\"model.f_payfee_department\" disabled>\r\n        </div>\r\n      </div>\r\n      <div class=\"col-sm-6\">\r\n        <label class=\"control-label col-sm-4\">操作人：</label>\r\n        <div class=\"col-sm-8\">\r\n          <input class=\"form-control\" type=\"text\" v-model=\"model.f_payfee_operator\" disabled>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n\r\n  <!--  <div class=\"from-group col-sm-12\">\r\n      <center>\r\n        <button type=\"button\" @click=\"goback()\" class=\"btn btn-primary\" style=\"width:80px; margin-left:50px;\"\r\n                :disabled=\"$v.invalid\">\r\n          保存\r\n        </button>\r\n        <button type=\"button\" @click=\"reset()\" class=\"btn btn-warning\" style=\"width:80px; margin-left:50px;\">\r\n          撤销\r\n        </button>\r\n      </center>\r\n    </div>-->\r\n    <modal :show.sync=\"showpay\" v-ref:modal backdrop=\"false\">\r\n      <header slot=\"modal-header\" class=\"modal-header\">\r\n        <button type=\"button\" class=\"close\" @click=\"close\"><span>&times;</span></button>\r\n        <h4 class=\"modal-title\">新增收费</h4>\r\n      </header>\r\n      <article slot=\"modal-body\" class=\"modal-body\">\r\n        <div v-if=\"showpay\">\r\n          <div class=\"from-group\">\r\n            <label>合同总金额(元)</label>\r\n            <input type=\"text\" class=\"form-control\" v-model=\"model.f_total_cost\" readonly>\r\n          </div>\r\n          <div class=\"from-group\">\r\n            <label>累计缴费金额(元)</label>\r\n            <input type=\"text\" class=\"form-control\" v-model=\"model.f_cumulative_money\" readonly>\r\n          </div>\r\n          <div class=\"from-group\">\r\n            <label>未结总金额(元)</label>\r\n            <input type=\"text\" class=\"form-control\" v-model=\"model.f_unaccounts_money\" readonly>\r\n          </div>\r\n          <div class=\"from-group\">\r\n            <label>金额(元)</label>\r\n            <input type=\"text\" :placeholder=model.f_unaccounts_money class=\"form-control\"\r\n                   v-model=\"addItem.f_charge_money\" @blur=\"check()\">\r\n          </div>\r\n          <div class=\"from-group\">\r\n            <label>金额大写</label>\r\n            <input type=\"text\" class=\"form-control\" v-model=\"getCapital\" readonly>\r\n          </div>\r\n          <!--<div class=\"from-group\">-->\r\n          <!--<label>缴费类型</label>-->\r\n\r\n          <!--<v-select  :options=\"f_payment_type\"-->\r\n          <!--v-model=\"addItem.f_payment_typed\"  :value.sync=\"addItem.f_payment_typed\"  close-on-select>-->\r\n          <!--</v-select>-->\r\n          <!--</div>-->\r\n          <div class=\"from-group\">\r\n            <label>交费日期</label>\r\n            <div>\r\n              <datepicker width=\"600.76px;\"\r\n                          :value.sync=\"addItem.f_charge_date\"\r\n                          :format=\"'yyyy-MM-dd'\"\r\n                          v-model=\"addItem.f_charge_date\" readonly=\"readonly\"\r\n                          :show-reset-button=\"reset\">\r\n              </datepicker>\r\n            </div>\r\n          </div>\r\n\r\n\r\n          <div class=\"from-group\">\r\n            <label>备注</label>\r\n            <input type=\"text\" class=\"form-control\" v-model=\"addItem.f_charge_remarks\">\r\n            <!--<input-select :value.sync=\"addItem.f_charge_remarks\" v-model=\"addItem.f_charge_remarks\"-->\r\n            <!--:options='feeoptions' @change=\"change\" close-on-select></input-select>-->\r\n          </div>\r\n        </div>\r\n      </article>\r\n      <footer slot=\"modal-footer\" class=\"modal-footer\">\r\n        <button v-show=\"showpay\" type=\"button\" class=\"btn btn-default\" @click='close'>取消</button>\r\n        <button v-show=\"showpay\" type=\"button\" class=\"btn btn-success\" @click='confirm'>确认</button>\r\n      </footer>\r\n    </modal>\r\n  </div>\r\n</template>\r\n<script>\r\n  import {HttpResetClass} from 'vue-client'\r\n  import InputAndSelect from \"vue-client/src/vue-strap/src/InputAndSelect\";\r\n\r\n  let gen = function* (self, val) {\r\n    val.f_actualfee_type = val.f_actualfee_type[0]\r\n    val.f_bill_type = val.f_bill_type[0]\r\n    yield self.$resetpost('rs/logic/saveentity', {data: {tablename: 't_apply', parameters: val}})\r\n    delete val.id\r\n    self.$resetpost('rs/logic/saveentity', {data: {tablename: 't_record', parameters: val}})\r\n      .then(() => {\r\n        self.reset()\r\n      })\r\n  }\r\n  export default {\r\n    components: {InputAndSelect},\r\n    title: '报装收费',\r\n    data() {\r\n      return {\r\n        showpay: false, // 新增收费模态框开关\r\n        addItem: null, // 模态框数据\r\n        model: {\r\n          subcost: 0, // 剩余付款\r\n          f_total_cost: 0, // 总费用\r\n          f_payfee_operator: '',//操作人\r\n          f_payfee_department: '',//操作部门\r\n          f_filiale: '',//分公司\r\n          f_payfee_date: '',//操作日期\r\n          f_cumulative_money: 0,//累计缴费金额\r\n          f_unaccounts_money: '',//未结总金额\r\n          f_cumulative_invoicing: '',//--累计开票金额--\r\n          f_residual_invoicing: '',//剩余开票金额\r\n          f_main_contract_num: 0,//主合同编号\r\n          rows: [] // 付费数据数组\r\n        },\r\n        f_payment_type: [\r\n          {label: '分期', value: '分期'},\r\n          {label: '一次付清', value: '一次付清'}\r\n        ],\r\n        chargemoney:0\r\n      }\r\n    },\r\n    props: ['infee'],\r\n    ready() {\r\n      this.load() // 初始化数据\r\n      this.model.f_payfee_operator = this.$login.f.name\r\n      this.model.f_payfee_department = this.$login.f.f_parentname\r\n      this.model.f_filiale = this.$login.f.f_fengongsi\r\n      this.model.f_payfee_date = this.$login.toStandardDateString()\r\n      // this.infee.f_actualfee_type = [this.infee.f_actualfee_type ? this.infee.f_actualfee_type : '']\r\n      // this.infee.f_bill_type = [this.infee.f_bill_type ? this.infee.f_bill_type : '']\r\n      // this.model = Object.assign({}, this.model, this.infee)\r\n      // this.model.f_actualfee = '0'\r\n      // this.model.f_actualfee_type = '现金缴费'\r\n      // delete this.model.id\r\n    },\r\n    methods: {\r\n      // 输入金额校验\r\n      check() {\r\n        console.log('check')\r\n        let re = /^[+-]?\\d+(\\.\\d+)?$/  //判断字符串是否为数字\r\n        if (!this.addItem.f_charge_money) {//判断缴费金额是否为空\r\n          console.log('check1')\r\n          this.addItem.f_charge_money = this.model.f_unaccounts_money\r\n        } else {\r\n          if (!re.test(this.addItem.f_charge_money)) {\r\n            this.$showMessage(\"请输入数字\")\r\n            this.addItem.f_charge_money = ''\r\n            return false\r\n          }\r\n        }\r\n\r\n\r\n        return true\r\n      },\r\n      change() {\r\n        // 解决模态框数据不刷新的问题\r\n        if (this.addItem.f_charge_remarks === '开户费') {\r\n          this.addItem.f_charge_money = this.infee.f_account_cost ? this.infee.f_account_cost : 0\r\n        }\r\n        if (this.addItem.f_charge_remarks === '入户安装费') {\r\n          this.addItem.f_charge_money = this.infee.f_construction_cost ? this.infee.f_construction_cost : 0\r\n        }\r\n        if (this.addItem.f_charge_remarks === '材料费') {\r\n          this.addItem.f_charge_money = this.infee.f_material_cost ? this.infee.f_material_cost : 0\r\n        }\r\n        if (this.addItem.f_charge_remarks === '人工费') {\r\n          this.addItem.f_charge_money = this.infee.f_labor_cost ? this.infee.f_labor_cost : 0\r\n        }\r\n        if (this.addItem.f_charge_remarks === '改管费') {\r\n          this.addItem.f_charge_money = this.infee.f_change_pipeline_cost ? this.infee.f_change_pipeline_cost : 0\r\n        }\r\n        if (this.addItem.f_charge_remarks === '设备安装费') {\r\n          this.addItem.f_charge_money = this.infee.f_sbaz_cost ? this.infee.f_sbaz_cost : 0\r\n        }\r\n      },\r\n      // 小写转换大写\r\n      smalltoBIG(n) {\r\n        let fraction = ['角', '分'];\r\n        let digit = ['零', '壹', '贰', '叁', '肆', '伍', '陆', '柒', '捌', '玖'];\r\n        let unit = [['元', '万', '亿'], ['', '拾', '佰', '仟']];\r\n        let head = n < 0 ? '欠' : '';\r\n        n = Math.abs(n);\r\n\r\n        let s = '';\r\n\r\n        for (var i = 0; i < fraction.length; i++) {\r\n          s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');\r\n        }\r\n        s = s || '整';\r\n        n = Math.floor(n);\r\n\r\n        for (var i = 0; i < unit[0].length && n > 0; i++) {\r\n          let p = '';\r\n          for (var j = 0; j < unit[1].length && n > 0; j++) {\r\n            p = digit[n % 10] + unit[1][j] + p;\r\n            n = Math.floor(n / 10);\r\n          }\r\n          s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;\r\n        }\r\n        return head + s.replace(/(零.)*零元/, '元').replace(/(零.)+/g, '零').replace(/^整$/, '零元整')\r\n      },\r\n      //新增收费 开启模态框\r\n      add() {\r\n        this.addItem = null\r\n        this.showpay = true\r\n      },\r\n      // 关闭模态框\r\n      close() {\r\n        this.showpay = false\r\n        this.addItem = null\r\n      },\r\n      // 模态框确定按钮保存数据\r\n\r\n      //\r\n      // f_cumulative_money: 0,//累计缴费金额\r\n      //   f_unaccounts_money: '',//未结总金额\r\n      //   f_cumulative_invoicing: '',//--累计开票金额--\r\n      //   f_residual_invoicing: '',//剩余开票金额\r\n      async confirm() {\r\n        let flag = this.check()\r\n        if (!flag) {\r\n          return\r\n        }\r\n\r\n\r\n\r\n        console.log('f_charge_money' + Number(this.addItem.f_charge_money))\r\n        console.log('f_unaccounts_money' + Number(this.model.f_unaccounts_money))\r\n\r\n        if (Number(this.addItem.f_charge_money) > Number(this.model.f_unaccounts_money)) {\r\n          this.$showMessage(\"缴费金额不能大于剩余金额\")\r\n        } else if (this.addItem.f_charge_money == 0) {\r\n          this.$showMessage(\"不能缴费0元\")\r\n        } else {\r\n\r\n\r\n          let flag1 = this.accAdd(Number(this.addItem.f_charge_money), Number(this.model.f_cumulative_money))\r\n          let flag2 = this.accSub(Number(this.model.f_unaccounts_money), Number(this.addItem.f_charge_money))\r\n\r\n\r\n          if (this.addItem.f_payment_typed == '') {\r\n            this.addItem.f_payment_typed = '分期'\r\n            console.log('为空')\r\n          }\r\n\r\n\r\n          let http = new HttpResetClass()\r\n\r\n          this.addItem.f_charge_money = this.addItem.f_charge_money\r\n          this.addItem.f_amount_words = this.addItem.f_amount_words\r\n          // this.addItem.f_payment_type = this.addItem.f_payment_typed\r\n          this.addItem.f_charge_collectors = this.$login.f.name\r\n          this.addItem.f_charge_date = this.addItem.f_charge_date\r\n          this.addItem.f_charge_remarks = this.addItem.f_charge_remarks\r\n          this.addItem.f_filiale = this.$login.f.f_fengongsi\r\n          this.addItem.f_process_id = this.infee.f_process_id\r\n          this.model.rows.push(this.addItem)\r\n          this.addItem.f_charging_status = '有效'\r\n          let chargemoney= this.addItem.f_charge_money\r\n          this.chargemoney=this.addItem.f_charge_money\r\n          let data = {\r\n            tablename: 't_charge_record',\r\n            parameters: this.addItem\r\n          }\r\n          await http.load('POST', 'rs/logic/saveentity', {data: data}, {resolveMsg: null, rejectMsg: \"添加失败\"})\r\n            .then((res) => {\r\n              this.close()\r\n            })\r\n\r\n\r\n          data = {\r\n            f_cumulative_money: flag1,\r\n            f_unaccounts_money: flag2,\r\n            f_apply_num: this.infee.f_apply_num\r\n          }\r\n          await http.load('POST', 'rs/logic/updatechargemoney', {data: data}, {resolveMsg: null, rejectMsg: \"添加累计金额失败\"})\r\n            .then((res) => {\r\n              this.close()\r\n              this.load()\r\n            })\r\n          console.log(this.model.f_cumulative_invoicing)\r\n          console.log(chargemoney)\r\n          console.log(this.model.f_cumulative_invoicing)\r\n          console.log(this.model.f_residual_invoicing)\r\n          this.$showMessage('是否打票据', ['confirm', 'cancel']).then((res) => {\r\n            if (res === 'confirm') {\r\n              console.log('打印票据')\r\n              let invoiceInterface = true//开发票接口的结果\r\n              let flag1 = this.accAdd(Number(chargemoney), Number(this.model.f_cumulative_invoicing))\r\n              let flag2 = this.accSub(Number(this.model.f_residual_invoicing), Number(chargemoney))\r\n              if (invoiceInterface) {\r\n                let  data = {\r\n                  f_cumulative_invoicing: flag1,\r\n                  f_residual_invoicing: flag2,\r\n                  f_apply_num: this.infee.f_apply_num,\r\n                  f_invoice_num: '123'//发票号码,\r\n                }\r\n                http.load('POST', 'rs/logic/updateinvoicemoney', {data: data}, {\r\n                  resolveMsg: null,\r\n                  rejectMsg: \"修改开票金额失败\"\r\n                })\r\n                  .then((res) => {\r\n                    this.close()\r\n                    this.load()\r\n                  })\r\n\r\n\r\n              } else {\r\n                this.$showMessage('开发票失败')\r\n              }\r\n\r\n            } else {\r\n              this.goback()\r\n            }\r\n          })\r\n        }\r\n      },\r\n      async invoice(){\r\n        console.log('打印票据')\r\n        let http = new HttpResetClass()\r\n        let invoiceInterface = true//开发票接口的结果\r\n        let flag1 = this.accAdd(Number(this.chargemoney), Number(this.model.f_cumulative_invoicing))\r\n        let flag2 = this.accSub(Number(this.model.f_residual_invoicing), Number(this.chargemoney))\r\n\r\n        if (invoiceInterface) {\r\n          let  data = {\r\n            f_cumulative_invoicing: flag1,\r\n            f_residual_invoicing: flag2,\r\n            f_apply_num: this.infee.f_apply_num,\r\n            f_invoice_num: '123'//发票号码,\r\n          }\r\n          await http.load('POST', 'rs/logic/updateinvoicemoney', {data: data}, {\r\n            resolveMsg: null,\r\n            rejectMsg: \"修改开票金额失败\"\r\n          })\r\n            .then((res) => {\r\n              this.close()\r\n              this.load()\r\n            })\r\n\r\n\r\n        } else {\r\n          this.$showMessage('开发票失败')\r\n        }\r\n      },\r\n\r\n      goback() {\r\n        this.$dispatch('hiddenbtn')\r\n        this.showview = false\r\n      },\r\n      async tovoid(val) {\r\n        if (val.f_is_correct==='是') {\r\n          this.$showMessage('已冲正过，不能操作！')\r\n        } else {\r\n          let correctionInterface = true//冲正接口的结果\r\n          if (correctionInterface) {\r\n            let http = new HttpResetClass()\r\n            let data = {\r\n              tablename: 't_charge_record',\r\n              condition: `id = '${val.id}'`\r\n            }\r\n            let res = await http.load('POST', 'rs/sql/singleTable', {data: data}, {\r\n              resolveMsg: null,\r\n              rejectMsg: '获取付款数据失败'\r\n            })\r\n            let flag1 = this.accSub(Number(this.model.f_cumulative_money), Number(val.f_charge_money))  //累计缴费金额\r\n            let flag2 = this.accAdd(Number(this.model.f_unaccounts_money), Number(val.f_charge_money))//未结总金额\r\n            let flag3 = Number(this.model.f_cumulative_invoicing)//--累计开票金额--\r\n            let flag4 = Number(this.model.f_residual_invoicing)//剩余开票金额\r\n            if (res.data[0].f_invoice_num) {\r\n              flag3 = this.accSub(Number(this.model.f_cumulative_invoicing), Number(val.f_charge_money))\r\n              flag4 = this.accAdd(Number(this.model.f_residual_invoicing), Number(val.f_charge_money))\r\n            }\r\n            data = {\r\n              f_cumulative_money: flag1,\r\n              f_unaccounts_money: flag2,\r\n              f_cumulative_invoicing: flag3,\r\n              f_residual_invoicing: flag4,\r\n              f_apply_num: this.infee.f_apply_num,\r\n              id: val.id\r\n            }\r\n            this.$resetpost('rs/logic/tovoidcharge', data, {resolveMsg: '冲正成功', rejectMsg: '冲正失败'}).then((res) => {\r\n              this.load()\r\n            })\r\n          } else {\r\n            this.$showMessage('冲正接口调用失败！')\r\n          }\r\n        }\r\n      },\r\n      tomakeup(val) {\r\n        if (val.f_invoice_num ) {\r\n          this.$showMessage('此记录有票据,不能操作！')\r\n        }else{\r\n          this.invoice()\r\n        }\r\n      },\r\n      accSub(arg1, arg2) {\r\n        var r1, r2, m, n;\r\n        try {\r\n          r1 = arg1.toString().split(\".\")[1].length\r\n        } catch (e) {\r\n          r1 = 0\r\n        }\r\n        try {\r\n          r2 = arg2.toString().split(\".\")[1].length\r\n        } catch (e) {\r\n          r2 = 0\r\n        }\r\n        m = Math.pow(10, Math.max(r1, r2));\r\n        //last modify by deeka\r\n        //动态控制精度长度\r\n        n = (r1 >= r2) ? r1 : r2;\r\n        return ((arg1 * m - arg2 * m) / m).toFixed(n);\r\n      },\r\n      reset() {\r\n        this.$dispatch('close')\r\n        this.$dispatch('selfsearch')\r\n      },\r\n      accAdd(arg1, arg2) {\r\n        var r1, r2, m;\r\n        try {\r\n          r1 = arg1.toString().split(\".\")[1].length\r\n        } catch (e) {\r\n          r1 = 0\r\n        }\r\n        try {\r\n          r2 = arg2.toString().split(\".\")[1].length\r\n        } catch (e) {\r\n          r2 = 0\r\n        }\r\n        m = Math.pow(10, Math.max(r1, r2))\r\n        return (arg1 * m + arg2 * m) / m\r\n      },\r\n\r\n      // 获取数据\r\n      async load() {\r\n        let http = new HttpResetClass()\r\n        let data = {\r\n          columnname: 'f_contract_money',\r\n          tablename: 't_contract',\r\n          condition: `processid = '${this.infee.f_process_id}'`\r\n          //\r\n        }\r\n        let res = await http.load('POST', 'rs/sql/getSum', {data: data}, {resolveMsg: null, rejectMsg: '获取总金额失败'})\r\n        this.model.f_total_cost = res.data[0].f_contract_money\r\n        data = {\r\n          tablename: 't_charge_record',\r\n          condition: `f_process_id = '${this.infee.f_process_id}'`\r\n        }\r\n\r\n\r\n        res = await http.load('POST', 'rs/sql/singleTable', {data: data}, {resolveMsg: null, rejectMsg: '获取付款数据失败'})\r\n        // 去除付款时间的时分秒\r\n        for (var i = 0; i < res.data.length; i++) {\r\n          res.data[i].f_charge_date = res.data[i].f_charge_date.substring(0, 11)\r\n        }\r\n        this.model.rows = res.data\r\n\r\n\r\n        data = {\r\n          tablename: 't_contract',\r\n          condition: `processid = '${this.infee.f_process_id}'`\r\n        }\r\n\r\n        res = await http.load('POST', 'rs/sql/singleTable', {data: data}, {resolveMsg: null, rejectMsg: '获取主合同编号失败'})\r\n        for (var i = 0; i < res.data.length; i++) {\r\n          if (res.data[i].f_contract_number) {\r\n            this.model.f_main_contract_num = res.data[i].f_contract_number\r\n          }\r\n        }\r\n\r\n\r\n        data = {\r\n          tablename: 't_apply',\r\n          condition: `f_apply_num = '${this.infee.f_apply_num}'`\r\n        }\r\n\r\n        res = await http.load('POST', 'rs/sql/singleTable', {data: data}, {resolveMsg: null, rejectMsg: '获取累计数据失败'})\r\n        this.model.f_cumulative_money = Number(res.data[0].f_cumulative_money)\r\n        this.model.chargemoney = Number(res.data[0].f_cumulative_money)\r\n        this.model.f_unaccounts_money = Number(res.data[0].f_unaccounts_money)\r\n        this.model.f_cumulative_invoicing = Number(res.data[0].f_cumulative_invoicing)\r\n        this.model.f_residual_invoicing = Number(res.data[0].f_residual_invoicing)\r\n      }\r\n      //   confirm() {\r\n      //     // this.model.f_change_pipeline_cost = this.model.f_change_pipeline_cost\r\n      //     // this.model.f_material_cost = this.model.f_material_cost\r\n      //     // this.model.f_labor_cost = this.model.f_labor_cost\r\n      //     // this.model.f_sbaz_cost = this.model.f_sbaz_cost\r\n      //     // this.model.f_construction_cost = this.model.f_construction_cost\r\n      //     // this.model.f_total_cost = this.model.f_total_cost\r\n      //\r\n      //     this.model.f_fee = this.model.f_actualfee\r\n      //     this.model.f_actualfee = Number(this.infee.f_actualfee) + Number(this.model.f_actualfee)\r\n      //     this.model.f_paytype = this.model.f_actualfee_type\r\n      //     this.model.f_payfeedate = this.model.f_payfee_date\r\n      //     this.model.f_payer = this.model.f_actualfee_user\r\n      //     this.model.applyid = this.model.id\r\n      //     this.model.f_state = '已交款'\r\n      //     this.model.f_operator = this.model.f_payfee_operator\r\n      //     this.model.f_date = this.model.f_payfee_date\r\n      //     this.model.f_department = this.model.f_payfee_department\r\n      //     // this.model.f_filiale = this.model.f_filiale\r\n      //     this.model.f_operat_type = '报建收费'\r\n      //     this.model.f_state = '有效'\r\n      //     this.model.f_describe = this.model.f_user_name + '缴费' + this.model.f_fee\r\n      //     console.log('输出model', this.model)\r\n      //     let getGen = gen(this, this.model)\r\n      //     co(getGen)\r\n      //     this.$dispatch('searchcard')\r\n      //     this.$dispatch('hiddenbtn')\r\n      //   },\r\n      //   reset() {\r\n      //     this.$dispatch('hiddenbtn')\r\n      //     // this.$dispatch('hiddenbtn')\r\n      //   }\r\n      // },\r\n\r\n    },\r\n    computed: {\r\n      // 计算大写\r\n      getCapital() {\r\n        if (this.addItem.f_charge_money) {\r\n          this.addItem.f_amount_words = this.smalltoBIG(Number(this.addItem.f_charge_money))\r\n        }\r\n\r\n        return this.addItem.f_amount_words\r\n      },\r\n      // subcost() {\r\n      //   let temp = Number(this.model.f_total_cost)\r\n      //   let temp2 = 0\r\n      //   for (var i = 0; i < this.model.rows.length; i++) {\r\n      //     temp2 += Number(this.model.rows[i].f_fee)\r\n      //   }\r\n      //   this.model.f_cumulative_money = Math.round(temp2 * 100) / 100\r\n      //   this.model.subcost = Math.round((temp - temp2) * 100) / 100\r\n      //   if (this.model.f_cumulative_money && this.model.f_jmhj_cost) {\r\n      //     temp = Math.round((temp - Number(this.model.f_jmhj_cost)) * 100) / 100\r\n      //   }\r\n      //   this.model.subcost = Math.round((temp - temp2) * 100) / 100\r\n      //   return this.model.subcost\r\n      // },\r\n      // totalcost () {\r\n      //   this.model.f_total_cost = Number(this.model.f_construction_cost) + Number(this.model.f_material_cost)\r\n      //      + Number(this.model.f_labor_cost) + Number(this.model.f_change_pipeline_cost)\r\n      //      + Number(this.model.f_sbaz_cost) - Number(this.model.f_jmhj_cost)\r\n      //   return this.model.f_total_cost\r\n      // },\r\n      // aaa() {\r\n      //   this.model.f_jmhj_cost = Number(this.model.f_total_cost) - Number(this.model.f_actualfee)\r\n      //   return this.model.f_jmhj_cost\r\n      // },\r\n      feeoptions() {\r\n        return this.$appdata.getParam('费用类型')\r\n      },\r\n      dayin() {\r\n        return this.$appdata.getParam('打印格式')\r\n      },\r\n      jiaofei() {\r\n        return this.$appdata.getParam('缴费类型')\r\n        // return [{label: '全部', value: ''}, ...AppData.getParam('缴费类型')]\r\n      }\r\n    }\r\n  }\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// InstallFee.vue?24b10650","module.exports = \" <div class=\\\"col-sm-12 auto select-overspread\\\"> <div class=\\\"auto select-overspread\\\"> <div class=\\\"panel panel-info\\\"> <div class=\\\"panel-heading auto\\\"> <h3 class=panel-title>报装收费</h3> </div> </div> </div> <div class=col-sm-12> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">合同编号:{{model.f_main_contract_num}}</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">合同总金额:{{model.f_total_cost}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">累计缴费金额:{{model.f_cumulative_money}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">未结总金额:{{model.f_unaccounts_money}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">累计开票金额:{{model.f_cumulative_invoicing}}元</span> <span class=col-sm-3 v-show=\\\"!($login.f.f_fengongsi.includes('彩虹'))\\\">未开票金额:{{model.f_residual_invoicing}}元</span> <button type=button class=\\\"btn btn-warning col-sm-2\\\" @click=add()>新增收费</button> </div> <div class=col-sm-12 style=\\\"height: auto\\\"> <div class=\\\"form-inline auto\\\" style=\\\"margin-bottom: 5px\\\"> </div> <div class=\\\"col-sm-12 span recordTable\\\" style=\\\"margin-top: 10px;min-height: 350px\\\"> <partial-view v-ref:single-load> <data-grid :model=model v-ref:grid> <template partial=head> <tr> <th>序号</th> <th>收费金额(元)</th> <th>金额大写</th> <th>缴费类型</th> <th>收费人员</th> <th>状态</th> <th>日期</th> <th>备注</th> <th>操作</th> </tr> </template> <template partial=body> <td style=\\\"text-align: center\\\">{{$index+1}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_money}}</td> <td style=\\\"text-align: center\\\">{{row.f_amount_words}}</td> <td style=\\\"text-align: center\\\">{{row.f_payment_type}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_collectors}}</td> <td style=\\\"text-align: center\\\">{{row.f_charging_status}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_date}}</td> <td style=\\\"text-align: center\\\">{{row.f_charge_remarks}}</td> <td class=flex-around> <button type=button name=button class=\\\"btn btn-link\\\" @click.stop=$parent.$parent.$parent.tomakeup(row)>补开票据 </button> <button type=button name=button class=\\\"btn btn-link\\\" @click.stop=$parent.$parent.$parent.tovoid(row)>冲正 </button> </td> </template> </data-grid> </partial-view> </div> </div> <div class=\\\"form-group col-sm-12\\\"> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">分公司：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_filiale disabled=disabled> </div> </div> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">操作日期：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_payfee_date disabled=disabled> </div> </div> </div> <div class=\\\"form-group col-sm-12\\\"> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">部门：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_payfee_department disabled=disabled> </div> </div> <div class=col-sm-6> <label class=\\\"control-label col-sm-4\\\">操作人：</label> <div class=col-sm-8> <input class=form-control type=text v-model=model.f_payfee_operator disabled=disabled> </div> </div> </div> <modal :show.sync=showpay v-ref:modal backdrop=false> <header slot=modal-header class=modal-header> <button type=button class=close @click=close><span>&times;</span></button> <h4 class=modal-title>新增收费</h4> </header> <article slot=modal-body class=modal-body> <div v-if=showpay> <div class=from-group> <label>合同总金额(元)</label> <input type=text class=form-control v-model=model.f_total_cost readonly=readonly> </div> <div class=from-group> <label>累计缴费金额(元)</label> <input type=text class=form-control v-model=model.f_cumulative_money readonly=readonly> </div> <div class=from-group> <label>未结总金额(元)</label> <input type=text class=form-control v-model=model.f_unaccounts_money readonly=readonly> </div> <div class=from-group> <label>金额(元)</label> <input type=text :placeholder=model.f_unaccounts_money class=form-control v-model=addItem.f_charge_money @blur=check()> </div> <div class=from-group> <label>金额大写</label> <input type=text class=form-control v-model=getCapital readonly=readonly> </div> <div class=from-group> <label>交费日期</label> <div> <datepicker width=600.76px; :value.sync=addItem.f_charge_date :format=\\\"'yyyy-MM-dd'\\\" v-model=addItem.f_charge_date readonly=readonly :show-reset-button=reset> </datepicker> </div> </div> <div class=from-group> <label>备注</label> <input type=text class=form-control v-model=addItem.f_charge_remarks> </div> </div> </article> <footer slot=modal-footer class=modal-footer> <button v-show=showpay type=button class=\\\"btn btn-default\\\" @click=close>取消</button> <button v-show=showpay type=button class=\\\"btn btn-success\\\" @click=confirm>确认</button> </footer> </modal> </div> \";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-html-loader!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/product/Function/functions/InstallFee.vue\n// module id = 816\n// module chunks = 86","var __vue_script__, __vue_template__\nvar __vue_styles__ = {}\n__vue_script__ = require(\"!!babel-loader?presets[]=es2015&plugins[]=transform-runtime&comments=false!../../../../../node_modules/vue-loader/lib/selector.js?type=script&index=0!./InstallFee.vue\")\n__vue_template__ = require(\"!!vue-html-loader!../../../../../node_modules/vue-loader/lib/selector.js?type=template&index=0!./InstallFee.vue\")\nmodule.exports = __vue_script__ || {}\nif (module.exports.__esModule) module.exports = module.exports.default\nvar __vue_options__ = typeof module.exports === \"function\" ? (module.exports.options || (module.exports.options = {})) : module.exports\nif (__vue_template__) {\n__vue_options__.template = __vue_template__\n}\nif (!__vue_options__.computed) __vue_options__.computed = {}\nObject.keys(__vue_styles__).forEach(function (key) {\nvar module = __vue_styles__[key]\n__vue_options__.computed[key] = function () { return module }\n})\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/product/Function/functions/InstallFee.vue\n// module id = 1020\n// module chunks = 86"],"sourceRoot":""}